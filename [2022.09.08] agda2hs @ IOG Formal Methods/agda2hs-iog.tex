%% \documentclass[aspectratio=43]{beamer}
\documentclass[aspectratio=169]{beamer}
\usetheme[
  block=fill,
  background=light,
  titleformat=smallcaps,
  progressbar=frametitle,
  numbering=none,
]{metropolis}
%% \setbeamersize{text margin left=.5cm,text margin right=.5cm}
\usepackage{appendixnumberbeamer}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Packages
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Tikz
\usepackage{tikz}
\usetikzlibrary{arrows,positioning,matrix,fit,backgrounds,decorations.text,decorations.pathmorphing,calc,shapes}

% Colors
\usepackage{xcolor}
\usepackage{contour}

% Images
\usepackage{graphics}
\graphicspath{{img/}}

% Floating-point arithemtic
\usepackage{xfp}

% Multiple optional arguments
\usepackage{xargs}

% Flexible environments
\usepackage{environ}

% Names
\newcommand\agdatohs{\textsc{agda2hs}\xspace}
\newcommand\plutus{\textsc{Plutus}\xspace}
\newcommand\systemF{System \ensuremath{F^{\mu}_{\omega}}\xspace}

% Agda
\usepackage{agda}
\setlength{\mathindent}{0em}
\newfontfamily{\AgdaSerifFont}{Linux Libertine O}
\newfontfamily{\AgdaSansSerifFont}{Linux Biolinum O}
\newfontfamily{\AgdaTypewriterFont}{Linux Biolinum O}
\renewcommand{\AgdaFontStyle}[1]{{\AgdaSansSerifFont{}#1}}
\renewcommand{\AgdaKeywordFontStyle}[1]{{\AgdaSansSerifFont{}#1}}
\renewcommand{\AgdaStringFontStyle}[1]{{\AgdaTypewriterFont{}#1}}
\renewcommand{\AgdaCommentFontStyle}[1]{{\AgdaTypewriterFont{}#1}}
\renewcommand{\AgdaBoundFontStyle}[1]{\textit{\AgdaSerifFont{}#1}}

\usepackage{amsxtra}
\usepackage{newunicodechar}
\newunicodechar{∷}{::}

\usepackage{minted}
\newcommand\hs[1]{\mintinline{haskell}{#1}}
%% \setminted[haskell]{fontsize=\footnotesize}
%% \usemintedstyle{friendly}
\usepackage{fontspec}
\setmonofont[Scale=MatchLowercase]{FiraMono-Regular.otf}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Macros
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand\alert[1]{\textcolor{mLightBrown}{#1}}
\newcommand\todo[1]{\textcolor{red}{#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Fonts
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{relsize}
\usepackage[tt=false]{libertine}


\usepackage{yfonts}
\usepackage{xspace}
\newcommand\I{\textgoth{I}\xspace}
\newcommand\II{\textgoth{II}\xspace}
\newcommand\III{\textgoth{III}\xspace}

%----------------------------------------------------------------------------

\title{Reasonable Agda Is Correct Haskell:}
\subtitle{Writing Verified Haskell using \textbf{\agdatohs}}
\vspace{-1cm}

% ** image setup
\newcommand\img[2]{\includegraphics[keepaspectratio=true,height=#1]{#2}}
\newcommand\smallImg[1]{\img{1.7em}{#1}}
\newcommand\medImg[1]{\img{1cm}{#1}}
\newcommand\largeImg[1]{\img{2.5cm}{#1}}

\newcommand*\vmid[1]{\vcenter{\hbox{#1}}}

\newcommand\agdaHsLove{%
$
\vmid{\smallImg{agda}}
\vmid{\scalebox{1.5}{\ +\ }}
\vmid{\smallImg{haskell}}
\vmid{\scalebox{1.5}{\ =\ }}
\vmid{\smallImg{heart}}
$
}

% ** code setup
\newcommand\resetVars{
  \def\sourceRatio{.5}
  \def\zoom{1}
  \def\hsFontsize{\normalsize}
  \def\midruleL{-1cm}
  \def\midruleR{.5cm}
  \def\sourceIcon{agda}
}
\resetVars

\newminted{haskell}{fontsize=\hsFontsize}

\def\hsSize{\fpeval{1 - \sourceRatio}}
\def\leftSize{\sourceRatio\textwidth}
\def\rightSize{\hsSize\textwidth}
\newcommand\midrule{\hspace{\midruleL}\vrule\hspace{\midruleR}}

\newcommand\codeLogos{%
\hspace{\fpeval{\sourceRatio / 2}\textwidth}
\hspace{-1cm}\img{1cm}{\sourceIcon}
\hspace{\fpeval{(\sourceRatio / 2) + (\hsSize / 2)}\textwidth}
\hspace{-1cm}\img{1cm}{haskell}
}

\NewEnviron{sourcepage}[0]{%
  \scalebox{\zoom}{
    \begin{minipage}{\leftSize}
    \BODY
    \end{minipage}
  }
}

\author{Jesper Cockx, \alert{Orestis Melkonian}, Lucas Escot, James Chapman, Ulf Norell}
\date{}
\titlegraphic{
\vspace*{6cm}
\begin{center}
\[
\vmid{\largeImg{agda}}
\vmid{\scalebox{2}{\Huge$\ +\ $}}
\vmid{\largeImg{haskell}}
\vmid{\scalebox{2}{\Huge$\ =\ $}}
\vmid{\largeImg{heart}}
\]
\end{center}
}

\begin{document}

% ** Agda setup
\AgdaNoSpaceAroundCode{}
\begin{code}[hide]%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--erase-record-parameters}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Haskell.Prelude}\AgdaSpace{}%
\AgdaKeyword{hiding}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaField{compare}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{LT}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{EQ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{GT}\<%
\\
%
\>[2]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{if\AgdaUnderscore{}then\AgdaUnderscore{}else\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{id}\<%
\\
%
\>[2]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{head}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{error}\<%
\\
%
\>[2]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaRecord{Monoid}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{mempty}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{mappend}\<%
\\
%
\>[2]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{ShowS}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{showString}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{showParen}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{defaultShowList}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaRecord{Show}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{show}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{showList}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{showsPrec}\<%
\\
%
\>[2]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaGeneralizable{f}\<%
\\
%
\>[2]\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{P}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaModule{Haskell.Prelude}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{FOREIGN}\AgdaSpace{}%
\AgdaPragma{AGDA2HS}\<%
\\
\>[0]\AgdaPragma{import}\AgdaSpace{}%
\AgdaPragma{Prelude}\AgdaSpace{}%
\AgdaPragma{as}\AgdaSpace{}%
\AgdaPragma{P}\AgdaSpace{}%
\AgdaPragma{hiding}\AgdaSpace{}%
\AgdaPragma{(compare,}\AgdaSpace{}%
\AgdaPragma{LT,}\AgdaSpace{}%
\AgdaPragma{EQ,}\AgdaSpace{}%
\AgdaPragma{GT)}\<%
\\
\>[0]\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≤\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{zero-≤}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
%
\>[2]\AgdaInductiveConstructor{suc-≤}%
\>[9]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Comparison}\AgdaSpace{}%
\AgdaSymbol{(@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{LT}%
\>[6]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{pf}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Comparison}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
%
\>[2]\AgdaInductiveConstructor{EQ}%
\>[6]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{pf}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Comparison}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
%
\>[2]\AgdaInductiveConstructor{GT}%
\>[6]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{pf}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Comparison}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaDatatype{Comparison}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{Ordered}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Ordering}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\<%
\\
\>[0]\AgdaFunction{Ordered}\AgdaSpace{}%
\AgdaInductiveConstructor{P.LT}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
\>[0]\AgdaFunction{Ordered}\AgdaSpace{}%
\AgdaInductiveConstructor{P.EQ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
\>[0]\AgdaFunction{Ordered}\AgdaSpace{}%
\AgdaInductiveConstructor{P.GT}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{m}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{<-correct-true}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{True}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
\>[0]\AgdaFunction{<-correct-true}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}%
\>[23]\AgdaBound{n}%
\>[31]\AgdaBound{eq}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{zero-≤}\<%
\\
\>[0]\AgdaFunction{<-correct-true}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{suc-≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{<-correct-true}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{<-correct-false}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{False}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{m}\<%
\\
\>[0]\AgdaFunction{<-correct-false}\AgdaSpace{}%
\AgdaBound{m}%
\>[24]\AgdaInductiveConstructor{zero}%
\>[32]\AgdaBound{eq}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{zero-≤}\<%
\\
\>[0]\AgdaFunction{<-correct-false}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{suc-≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{<-correct-false}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{==-correct-true}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaField{==}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{True}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
\>[0]\AgdaFunction{==-correct-true}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{==-correct-true}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{==-correct-true}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{compare-correct}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Ordered}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{P.compare}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
\>[0]\AgdaFunction{compare-correct}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaKeyword{in}\AgdaSpace{}%
\AgdaArgument{eq<}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaField{==}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaKeyword{in}\AgdaSpace{}%
\AgdaArgument{eq=}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{False}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{False}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{<-correct-false}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{eq<}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{False}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{True}%
\>[20]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{==-correct-true}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{eq=}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{True}%
\>[12]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}%
\>[20]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{<-correct-true}%
\>[38]\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{eq<}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{compare}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Comparison}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
\>[0]\AgdaFunction{compare}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{aux}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{P.compare}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{compare-correct}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{aux}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{o}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Ordering}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaFunction{Ordered}\AgdaSpace{}%
\AgdaBound{o}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Comparison}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
%
\>[4]\AgdaFunction{aux}\AgdaSpace{}%
\AgdaInductiveConstructor{P.LT}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{LT}\<%
\\
%
\>[4]\AgdaFunction{aux}\AgdaSpace{}%
\AgdaInductiveConstructor{P.EQ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{EQ}\<%
\\
%
\>[4]\AgdaFunction{aux}\AgdaSpace{}%
\AgdaInductiveConstructor{P.GT}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{GT}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaFunction{compare}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{variable}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaGeneralizable{A}\AgdaSpace{}%
\AgdaGeneralizable{B}\AgdaSpace{}%
\AgdaGeneralizable{C}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\<%
\\
%
\>[2]\AgdaGeneralizable{x}\AgdaSpace{}%
\AgdaGeneralizable{y}\AgdaSpace{}%
\AgdaGeneralizable{z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{A}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{postulate}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaPostulate{⋯}\AgdaSpace{}%
\AgdaPostulate{TODO}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{A}\<%
\end{code}

\begin{center}
\setbeamerfont{title}{size=\LARGE}
\setbeamerfont{subtitle}{size=\Large}
\vspace*{-2cm}
\maketitle
%% \setbeamerfont{title}{size=\Large}
%% \setbeamerfont{subtitle}{size=\large}
\end{center}

\begin{frame}[fragile]{Motivation: issues with current program extractors}
\def\hsFontsize{\tiny}
\textbf{MAlonzo} covers the entirety of Agda, but produces unreadable code:

\codeLogos
\begin{sourcepage}
\begin{code}[hide]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{MAlonzo}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaInductiveConstructor{Leaf}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Tree}\<%
\\
%
\>[4]\AgdaInductiveConstructor{Node}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\<%
\end{code}
\begin{code}%
%
\>[2]\AgdaFunction{insert}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\<%
\\
%
\>[2]\AgdaFunction{insert}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaInductiveConstructor{Leaf}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaInductiveConstructor{Leaf}\AgdaSpace{}%
\AgdaInductiveConstructor{Leaf}\<%
\\
%
\>[2]\AgdaFunction{insert}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{r}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaOperator{\AgdaFunction{case}}\AgdaSpace{}%
\AgdaFunction{compare}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{of}}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(}\AgdaInductiveConstructor{LT}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{insert}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{r}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaInductiveConstructor{EQ}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{r}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaInductiveConstructor{GT}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{insert}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{r}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaFunction{insert}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\end{code}
\end{sourcepage}
\midrule
\begin{minipage}{\rightSize}
\begin{haskellcode}
d_insert_1494 :: Integer -> Integer -> Integer
              -> T_Tree_1340 -> T__'8804'__1324
              -> T__'8804'__1324 -> T_Tree_1340
d_insert_1494 ~v0 ~v1 v2 v3 ~v4 ~v5 = du_insert_1494 v2 v3
du_insert_1494 :: Integer -> T_Tree_1340 -> T_Tree_1340
du_insert_1494 v0 v1 = case coe v1 of
  C_Leaf_1348 ->
    coe C_Node_1352 (coe v0) (coe C_Leaf_1348)
      (coe C_Leaf_1348)
  C_Node_1352 v2 v3 v4 ->
    coe MAlonzo.Code.Haskell.Prim.du_case_of__54
      (coe d_compare_1474 (coe v0) (coe v2))
      (coe du_'46'extendedlambda0_1514 (coe v0) (coe v2)
        (coe v3) (coe v4))
  _ -> MAlonzo.RTE.mazUnreachableError
\end{haskellcode}
\end{minipage}
\resetVars
\end{frame}

\begin{frame}[fragile]{Motivation: issues with current program extractors}
\def\sourceIcon{coq}
\def\modruleL{-.5cm}
\def\hsFontsize{\scriptsize}
\textbf{Coq} extracts more reabable code, but still does not readily support typeclasses:

\codeLogos

\hspace{-.5cm}
\begin{minipage}{.5\textwidth}
\begin{minted}[fontsize=\hsFontsize]{coq}
Class Monoid (a : Set) :=
  { mempty  : a
  ; mappend : a -> a -> a }.

Instance MonoidNat : Monoid nat :=
  { mempty := 0
  ; mappend i j := i + j }.

Fixpoint sumMon {a} `{Monoid a}
  (xs : list a) : a :=
  match xs with
  | [] => mempty
  | x :: xs => mappend x (sumMon xs)
  end.
\end{minted}
\end{minipage}
\midrule
\begin{minipage}{.5\textwidth}
\begin{haskellcode}
data Monoid a = Build_Monoid a (a -> a -> a)

mempty :: (Monoid a1) -> a1
mempty = ...
mappend :: (Monoid a1) -> a1 -> a1 -> a1
mappend = ...
monoidNat :: Monoid Nat
monoidNat = Build_Monoid O add

sumMon :: (Monoid a1) -> (List a1) -> a1
sumMon h xs = case xs of {
  ([]) -> mempty h;
  (:) x xs0 -> mappend h x (sumMon h xs0)}
\end{haskellcode}
\end{minipage}
\resetVars
\end{frame}

\begin{frame}[fragile]{Goals}
\begin{enumerate}
\item Writing Haskell within Agda (no need to cover the whole source language)
\item Verify your program using Agda's dependent types
\end{enumerate}
\pause
\textbf{New point} in the design space, enabled by:
\begin{itemize}
\item Agda very \textit{similar} to Haskell \hspace{.5cm}\agdaHsLove{}
\item Agda's \textit{dependent type system}
\item Agda's support for \textit{erasure}
\item[+] allows for \alert{intrinsic verification}!
\end{itemize}

\end{frame}

\begin{frame}[fragile]{Tree example (extrinsic version)}
\def\sourceRatio{.55}
\def\zoom{.9}
\def\hsFontsize{\small}
\codeLogos
\begin{sourcepage}
\begin{code}[hide]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Extrinsic}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\end{code}
\begin{code}%
\>[0][@{}l@{\AgdaIndent{1}}]%
\>[2]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaInductiveConstructor{Leaf}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Tree}\<%
\\
%
\>[4]\AgdaInductiveConstructor{Node}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\<%
\\
%
\>[2]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{insert}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\<%
\\
%
\>[2]\AgdaFunction{insert}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaInductiveConstructor{Leaf}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaInductiveConstructor{Leaf}\AgdaSpace{}%
\AgdaInductiveConstructor{Leaf}\<%
\\
%
\>[2]\AgdaFunction{insert}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{r}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaOperator{\AgdaFunction{case}}\AgdaSpace{}%
\AgdaFunction{compare}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{of}}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(}\AgdaInductiveConstructor{LT}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{insert}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{r}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaInductiveConstructor{EQ}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{r}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaInductiveConstructor{GT}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{insert}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{r}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaFunction{insert}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\end{code}
\end{sourcepage}
\midrule
\begin{minipage}{\rightSize}
\begin{haskellcode}
data Tree = Leaf
          | Node Natural Tree Tree

insert :: Natural -> Tree -> Tree
insert x Leaf = Node x Leaf Leaf
insert x (Node y l r)
  = case compare x y of
        LT -> Node y (insert x l) r
        EQ -> Node y l r
        GT -> Node y l (insert x r)
\end{haskellcode}
\end{minipage}
\resetVars
\end{frame}

\begin{frame}[fragile]{Tree example (extrinsic proofs)}
\def\sourceRatio{.6}
\def\midruleL{0cm}
\begin{sourcepage}
\hspace{2cm}$\vdots$
\begin{code}%
%
\>[2]\AgdaSymbol{@}\AgdaNumber{0}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≤\AgdaUnderscore{}≤\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\<%
\\
%
\>[2]\AgdaBound{l}%
\>[5]\AgdaOperator{\AgdaFunction{≤}}\AgdaSpace{}%
\AgdaInductiveConstructor{Leaf}%
\>[21]\AgdaOperator{\AgdaFunction{≤}}\AgdaSpace{}%
\AgdaBound{u}%
\>[26]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{u}\<%
\\
%
\>[2]\AgdaBound{l}%
\>[5]\AgdaOperator{\AgdaFunction{≤}}\AgdaSpace{}%
\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{tˡ}\AgdaSpace{}%
\AgdaBound{tʳ}%
\>[21]\AgdaOperator{\AgdaFunction{≤}}\AgdaSpace{}%
\AgdaBound{u}%
\>[26]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≤}}\AgdaSpace{}%
\AgdaBound{tˡ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≤}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≤}}\AgdaSpace{}%
\AgdaBound{tʳ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≤}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaSymbol{@}\AgdaNumber{0}\AgdaSpace{}%
\AgdaFunction{insert-correct}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≤}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≤}}\AgdaSpace{}%
\AgdaBound{u}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≤}}\AgdaSpace{}%
\AgdaFunction{insert}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≤}}\AgdaSpace{}%
\AgdaBound{u}\<%
\\
%
\>[2]\AgdaFunction{insert-correct}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{Leaf}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{l≤x}\AgdaSpace{}%
\AgdaBound{x≤u}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l≤x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x≤u}\<%
\\
%
\>[2]\AgdaFunction{insert-correct}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{tˡ}\AgdaSpace{}%
\AgdaBound{tʳ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{IHˡ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{IHʳ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{l≤x}\AgdaSpace{}%
\AgdaBound{x≤u}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{with}%
\>[10]\AgdaFunction{compare}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
%
\>[2]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}%
\>[9]\AgdaInductiveConstructor{LT}\AgdaSpace{}%
\AgdaBound{x≤y}%
\>[18]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{insert-correct}\AgdaSpace{}%
\AgdaBound{IHˡ}\AgdaSpace{}%
\AgdaBound{l≤x}\AgdaSpace{}%
\AgdaBound{x≤y}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{IHʳ}\<%
\\
%
\>[2]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}%
\>[9]\AgdaInductiveConstructor{EQ}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}%
\>[18]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{IHˡ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{IHʳ}\<%
\\
%
\>[2]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}%
\>[9]\AgdaInductiveConstructor{GT}\AgdaSpace{}%
\AgdaBound{y≤x}%
\>[18]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{IHˡ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{insert-correct}\AgdaSpace{}%
\AgdaBound{IHʳ}\AgdaSpace{}%
\AgdaBound{y≤x}\AgdaSpace{}%
\AgdaBound{x≤u}\<%
\end{code}
\end{sourcepage}
\midrule
\begin{minipage}{\rightSize}
\end{minipage}
\resetVars
\end{frame}

\begin{frame}[fragile]{Tree example (intrinsic version)}
\def\sourceRatio{.7}
\def\zoom{.85}
\def\hsFontsize{\footnotesize}
\def\midruleR{.25cm}
\codeLogos

\hspace{-.5cm}
\begin{sourcepage}
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaSymbol{(@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{u}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{Leaf}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{pf}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{u}\<%
\\
%
\>[2]\AgdaInductiveConstructor{Node}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{u}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{u}\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
\>[0]\AgdaFunction{insert}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{u}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{u}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≤}}\AgdaSpace{}%
\AgdaBound{u}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{u}\<%
\\
\>[0]\AgdaFunction{insert}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Leaf}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaBound{l≤x}\AgdaSpace{}%
\AgdaBound{x≤u}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Leaf}\AgdaSpace{}%
\AgdaBound{l≤x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Leaf}\AgdaSpace{}%
\AgdaBound{x≤u}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{insert}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{r}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{l≤x}\AgdaSpace{}%
\AgdaBound{x≤u}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{case}}\AgdaSpace{}%
\AgdaFunction{compare}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{of}}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{(}\AgdaInductiveConstructor{LT}\AgdaSpace{}%
\AgdaBound{x≤y}\AgdaSymbol{)}%
\>[14]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{insert}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{l≤x}\AgdaSpace{}%
\AgdaBound{x≤y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{r}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaInductiveConstructor{EQ}\AgdaSpace{}%
\AgdaBound{x≡y}\AgdaSymbol{)}%
\>[14]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{r}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaInductiveConstructor{GT}\AgdaSpace{}%
\AgdaBound{y≤x}\AgdaSymbol{)}%
\>[14]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{Node}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{insert}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{r}\AgdaSpace{}%
\AgdaBound{y≤x}\AgdaSpace{}%
\AgdaBound{x≤u}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaFunction{insert}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\end{code}
\end{sourcepage}
\midrule
\begin{minipage}{\rightSize}
\begin{haskellcode}
data Tree = Leaf
          | Node Natural Tree Tree

insert :: Natural -> Tree -> Tree
insert x Leaf = Node x Leaf Leaf
insert x (Node y l r)
  = case compare x y of
        LT -> Node y (insert x l) r
        EQ -> Node x l r
        GT -> Node y l (insert x r)
\end{haskellcode}
\end{minipage}
\resetVars
\end{frame}

\begin{frame}[fragile]{Primitives}

\begin{itemize}
\item Export lowercase type variables to feel like home
(i.e. \AgdaKeyword{variable} \AgdaBound{a b c ⋯ :} \AgdaDatatype{Set}):
\begin{code}%
\>[0]\AgdaFunction{id}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{a}\<%
\\
\>[0]\AgdaFunction{id}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{x}\<%
\end{code}

\pause
\item Match Agda built-ins to Haskell built-ins:

e.g. \AgdaDatatype{Agda.Builtin.Nat} $\leftrightarrow$ \hs{Numeric.Natural}

\pause
\item If not available in Agda, define them:

\begin{code}%
\>[0]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{-2}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{if\AgdaUnderscore{}then\AgdaUnderscore{}else\AgdaUnderscore{}}}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{if\AgdaUnderscore{}then\AgdaUnderscore{}else\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Bool}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{a}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{if}}\AgdaSpace{}%
\AgdaInductiveConstructor{False}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{then}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{else}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{if}}\AgdaSpace{}%
\AgdaInductiveConstructor{True}%
\>[9]\AgdaOperator{\AgdaFunction{then}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{else}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{x}\<%
\end{code}

\pause
\begin{alertblock}{REMEMBER}
We want to cover as many Haskell features as possible, not Agda features.
\end{alertblock}

\end{itemize}

\resetVars
\end{frame}

\begin{frame}[fragile]{Prelude}

Port Haskell's Prelude, staying faithful to the original functionality.

\pause

\def\sourceRatio{.65}
\def\zoom{.9}
\def\hsFontsize{\footnotesize}
\codeLogos
\begin{sourcepage}
\begin{code}%
\>[0]\AgdaFunction{error}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{⊥}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{String}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{a}\<%
\\
\>[0]\AgdaFunction{error}\AgdaSpace{}%
\AgdaSymbol{()}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{head}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaGeneralizable{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonEmpty}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{a}\<%
\\
\>[0]\AgdaFunction{head}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}%
\>[14]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{head}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{p}\AgdaSymbol{\}}%
\>[14]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{error}\AgdaSpace{}%
\AgdaFunction{i}\AgdaSpace{}%
\AgdaString{"empty\ list"}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[745I]\AgdaSymbol{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaFunction{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{⊥}\<%
\\
\>[.][@{}l@{}]\<[745I]%
\>[8]\AgdaFunction{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{case}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{of}}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaSymbol{()}\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaFunction{head}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\end{code}
\end{sourcepage}
\midrule
\begin{minipage}{\rightSize}
\begin{haskellcode}
head :: [a] -> a
head (x : _) = x
head [] = error "empty list"
\end{haskellcode}
\end{minipage}

\pause

\begin{alertblock}{Don't forget}
On the Haskell side, we can feed \hs{head} arbitrary input!
\end{alertblock}
\resetVars
\end{frame}

\begin{frame}[fragile]{Typeclasses}

Correspondence with Agda's \textbf{instance arguments}.
\begin{itemize}
\item class definitions $\sim$ record types
\item instance declarations $\sim$ record values
\item constraints $\sim$ instance arguments
\end{itemize}

\end{frame}

\begin{frame}[fragile]{Typeclasses: class definitions $\sim$ record types}
\def\sourceRatio{.65}
\def\hsFontsize{\small}
\codeLogos
\begin{sourcepage}
\begin{code}%
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{Monoid}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{field}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaField{mempty}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{a}\<%
\\
%
\>[4]\AgdaField{mappend}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{a}\<%
\\
%
\>[4]\AgdaSymbol{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaField{left-identity}%
\>[23]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{mappend}\AgdaSpace{}%
\AgdaField{mempty}\AgdaSpace{}%
\AgdaGeneralizable{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaGeneralizable{x}\<%
\\
%
\>[4]\AgdaSymbol{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaField{right-identity}%
\>[23]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{mappend}\AgdaSpace{}%
\AgdaGeneralizable{x}\AgdaSpace{}%
\AgdaField{mempty}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaGeneralizable{x}\<%
\\
%
\>[4]\AgdaSymbol{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaField{associativity}%
\>[23]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{mappend}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{mappend}\AgdaSpace{}%
\AgdaGeneralizable{x}\AgdaSpace{}%
\AgdaGeneralizable{y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaGeneralizable{z}\<%
\\
%
\>[23]\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaField{mappend}\AgdaSpace{}%
\AgdaGeneralizable{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{mappend}\AgdaSpace{}%
\AgdaGeneralizable{y}\AgdaSpace{}%
\AgdaGeneralizable{z}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Monoid}\AgdaSpace{}%
\AgdaSymbol{\{\{...\}\}}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaRecord{Monoid}\AgdaSpace{}%
\AgdaPragma{class}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\end{code}
\end{sourcepage}
\midrule
\begin{minipage}{\rightSize}
\begin{haskellcode}
class Monoid a where
  mempty :: a
  mappend :: a -> a -> a
\end{haskellcode}
\end{minipage}
\resetVars
\end{frame}

\begin{frame}[fragile]{Typeclasses: instance declarations $\sim$ record values}
\def\sourceRatio{.55}
\codeLogos
\begin{sourcepage}
\begin{code}%
\>[0]\AgdaKeyword{instance}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{MonoidNat}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Monoid}\AgdaSpace{}%
\AgdaDatatype{Nat}\<%
\\
%
\>[2]\AgdaFunction{MonoidNat}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{.}\AgdaField{mempty}%
\>[18]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaNumber{0}\<%
\\
%
\>[4]\AgdaSymbol{.}\AgdaField{mappend}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{j}%
\>[18]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaField{+}}\AgdaSpace{}%
\AgdaBound{j}\<%
\\
%
\>[4]\AgdaSymbol{.}\AgdaField{left-identity}%
\>[21]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{⋯}\<%
\\
%
\>[4]\AgdaSymbol{.}\AgdaField{right-identity}%
\>[21]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{⋯}\<%
\\
%
\>[4]\AgdaSymbol{.}\AgdaField{associativity}%
\>[21]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{⋯}\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaFunction{MonoidNat}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\end{code}
\end{sourcepage}
\midrule
\begin{minipage}{\rightSize}
\begin{haskellcode}
instance Monoid Nat where
  mempty = 0
  mappend i j = i + j
\end{haskellcode}
\end{minipage}
\resetVars
\end{frame}

\begin{frame}[fragile]{Typeclasses: constraints $\sim$ instance arguments}
\def\sourceRatio{.6}
\def\zoom{.95}
\def\midruleL{-1.2cm}
\def\hsFontsize{\footnotesize}
\codeLogos

\hspace{-.25cm}
\begin{sourcepage}
\begin{code}%
\>[0]\AgdaFunction{sumMon}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaRecord{Monoid}\AgdaSpace{}%
\AgdaGeneralizable{a}\AgdaSpace{}%
\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaGeneralizable{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{a}\<%
\\
\>[0]\AgdaFunction{sumMon}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}%
\>[17]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{mempty}\<%
\\
\>[0]\AgdaFunction{sumMon}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}%
\>[17]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{mappend}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sumMon}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaFunction{sumMon}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\end{code}
\end{sourcepage}
\midrule
\begin{minipage}{\rightSize}
\begin{haskellcode}
sumMon :: Monoid a => [a] -> a
sumMon [] = mempty
sumMon (x : xs) = mappend x (sumMon xs)
\end{haskellcode}
\end{minipage}
\resetVars
\end{frame}

\begin{frame}[fragile]{Default methods \& minimal complete definitions}
\def\sourceRatio{.65}
\def\zoom{.85}
\def\midruleL{-.5cm}
\def\midruleR{.1cm}
\def\hsFontsize{\footnotesize}
\codeLogos

\hspace{-.5cm}
\begin{sourcepage}
\begin{code}[hide]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Haskell.Prim.Bool}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Haskell.Prim.Foldable}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Haskell.Prim.Maybe}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{ShowS}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\<%
\\
\>[0]\AgdaFunction{ShowS}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{String}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{String}\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaFunction{ShowS}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{showString}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{String}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ShowS}\<%
\\
\>[0]\AgdaFunction{showString}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}++\AgdaUnderscore{}}}\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaFunction{showString}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{showParen}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Bool}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ShowS}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ShowS}\<%
\\
\>[0]\AgdaFunction{showParen}\AgdaSpace{}%
\AgdaInductiveConstructor{False}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
\>[0]\AgdaFunction{showParen}\AgdaSpace{}%
\AgdaInductiveConstructor{True}%
\>[16]\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{showString}\AgdaSpace{}%
\AgdaString{"("}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{showString}\AgdaSpace{}%
\AgdaString{")"}\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaFunction{showParen}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{defaultShowList}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ShowS}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaGeneralizable{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ShowS}\<%
\\
\>[0]\AgdaFunction{defaultShowList}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}%
\>[22]\AgdaInductiveConstructor{[]}%
\>[31]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{showString}\AgdaSpace{}%
\AgdaString{"[]"}\<%
\\
\>[0]\AgdaFunction{defaultShowList}\AgdaSpace{}%
\AgdaBound{shows}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{showString}\AgdaSpace{}%
\AgdaString{"["}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{foldl}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{showString}\AgdaSpace{}%
\AgdaString{","}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{shows}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{shows}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{showString}\AgdaSpace{}%
\AgdaString{"]"}\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaFunction{defaultShowList}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\end{code}
\begin{AgdaAlign}
\begin{code}%
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{Show}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{field}%
\>[9]\AgdaField{show}%
\>[20]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{String}\<%
\\
%
\>[9]\AgdaField{showsPrec}%
\>[20]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ShowS}\<%
\\
%
\>[9]\AgdaField{showList}%
\>[20]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ShowS}\<%
\\
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{Show₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{field}\AgdaSpace{}%
\AgdaField{showsPrec}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ShowS}\<%
\end{code}
\begin{code}[hide]%
%
\>[2]\AgdaFunction{show}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{String}\<%
\end{code}
\begin{code}%
%
\>[2]\AgdaFunction{show}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{showsPrec}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaString{""}\<%
\end{code}
\begin{code}[hide]%
%
\>[2]\AgdaFunction{showList}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ShowS}\<%
\end{code}
\begin{code}%
%
\>[2]\AgdaFunction{showList}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{defaultShowList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{showsPrec}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{Show₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{field}\AgdaSpace{}%
\AgdaField{show}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{String}\<%
\end{code}
\begin{code}[hide]%
%
\>[2]\AgdaFunction{showsPrec}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ShowS}\<%
\end{code}
\begin{code}%
%
\>[2]\AgdaFunction{showsPrec}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{show}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaBound{s}\<%
\end{code}
\begin{code}[hide]%
%
\>[2]\AgdaFunction{showList}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ShowS}\<%
\end{code}
\begin{code}%
%
\>[2]\AgdaFunction{showList}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{defaultShowList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{showsPrec}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Show}\AgdaSpace{}%
\AgdaSymbol{\{\{...\}\}}\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaRecord{Show}\AgdaSpace{}%
\AgdaPragma{class}\AgdaSpace{}%
\AgdaPragma{Show₁}\AgdaSpace{}%
\AgdaPragma{Show₂}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\end{code}
\end{AgdaAlign}
\end{sourcepage}
\midrule
\begin{minipage}{\rightSize}
\begin{haskellcode}
class Show a where
  show :: a -> String
  showsPrec :: Nat -> a -> ShowS
  showList :: [a] -> ShowS
  {-# MINIMAL showsPrec | show #-}
  show x = showsPrec 0 x ""
  showList = defaultShowList
             (showsPrec 0)
  showsPrec _ x s = show x ++ s
\end{haskellcode}
\end{minipage}
\resetVars
\end{frame}

\begin{frame}[fragile]{Minimal Instance}
\def\sourceRatio{.58}
\def\midruleL{-.6cm}
\def\midruleR{.05cm}
\def\hsFontsize{\footnotesize}
\codeLogos

\hspace{-1cm}
\begin{sourcepage}
\begin{code}%
\>[0]\AgdaKeyword{instance}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{ShowMaybe}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaRecord{Show}\AgdaSpace{}%
\AgdaGeneralizable{a}\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Show}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaGeneralizable{a}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{ShowMaybe}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{a}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaModule{Show₁}\AgdaSpace{}%
\AgdaFunction{s₁}\AgdaSymbol{\}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{s₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Show₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{s₁}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{Show₁.showsPrec}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaInductiveConstructor{Nothing}%
\>[18]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{showString}\AgdaSpace{}%
\AgdaString{"nothing"}\<%
\\
%
\>[8]\AgdaSymbol{(}\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[18]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{showParen}\AgdaSpace{}%
\AgdaInductiveConstructor{True}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{showString}\AgdaSpace{}%
\AgdaString{"just\ "}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaField{showsPrec}\AgdaSpace{}%
\AgdaNumber{10}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaFunction{ShowMaybe}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\end{code}
\end{sourcepage}
\midrule
\begin{minipage}{\rightSize}
\begin{haskellcode}
instance (Show a)
      => Show (Maybe a) where
  showsPrec n = \case
    Nothing -> showString "nothing"
    (Just x) -> showParen True
      (showString "just " . showsPrec 10 x)
\end{haskellcode}
\end{minipage}
\resetVars
\end{frame}

\begin{frame}[fragile]{\agdatohs in the wild}
IOG's Cardano blockchain
\begin{itemize}
\item currently the 8$^{th}$ largest by market cap
\item smart contracts written in \plutus, based on \systemF
\item implemented in Haskell
\item tested against Agda formalization
\end{itemize}
\pause
\vfill
\[
\vmid{\img{1.5cm}{plutus}}
\vmid{\scalebox{2}{\Large$\ +\ $}}
\vmid{\img{1.5cm}{agda}}
\vmid{\scalebox{2}{\Large$\ +\ $}}
\vmid{\img{1.5cm}{haskell}}
\vmid{\scalebox{2}{\Large$\ =\ $}}
\vmid{\img{1.5cm}{heart}}
\]
\end{frame}

\begin{frame}[fragile]{IOG use case: type renaming \& substitution}
\def\sourceRatio{.58}
\def\zoom{.9}
\def\midruleL{-.4cm}
\def\midruleR{.2cm}
\def\hsFontsize{\footnotesize}
\codeLogos

\hspace{-.7cm}
\begin{sourcepage}
\begin{code}[hide]%
\>[0]\AgdaComment{--\ open\ import\ Haskell.Prelude}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{sym}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{z}\<%
\\
\>[0]\AgdaFunction{trans}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
\>[0]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{subst}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
\>[0]\AgdaFunction{subst}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{begin\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{begin}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∎}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∎}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}=⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{z}\<%
\\
\>[0]\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{=⟨}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{trans}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}=⟨⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
\>[0]\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{=⟨⟩}}\AgdaSpace{}%
\AgdaBound{q}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{=⟨}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{begin\AgdaUnderscore{}}}\<%
\\
\>[0]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{3}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∎}}\<%
\\
\>[0]\AgdaKeyword{infixr}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}=⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}}}\<%
\\
\>[0]\AgdaKeyword{infixr}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}=⟨⟩\AgdaUnderscore{}}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{C}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{a'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{a'}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{b'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\<%
\\
%
\>[2]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{b'}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{a'}\AgdaSpace{}%
\AgdaBound{b'}\<%
\\
\>[0]\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{variable}\AgdaSpace{}%
\AgdaSymbol{@}\AgdaSymbol{0}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSpace{}%
\AgdaGeneralizable{n''}\AgdaSpace{}%
\AgdaGeneralizable{n′}\AgdaSpace{}%
\AgdaGeneralizable{n″}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\<%
\end{code}
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Kind}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{Star}%
\>[9]\AgdaSymbol{:}%
\>[12]\AgdaDatatype{Kind}\<%
\\
%
\>[2]\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}:=>\AgdaUnderscore{}}}%
\>[9]\AgdaSymbol{:}%
\>[12]\AgdaDatatype{Kind}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Kind}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Kind}\<%
\\
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{TyVar}%
\>[12]\AgdaSymbol{:}%
\>[15]\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
%
\>[2]\AgdaInductiveConstructor{TyFun}%
\>[12]\AgdaSymbol{:}%
\>[15]\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
%
\>[2]\AgdaInductiveConstructor{TyForall}%
\>[12]\AgdaSymbol{:}%
\>[15]\AgdaDatatype{Kind}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
%
\>[2]\AgdaInductiveConstructor{TyLam}%
\>[12]\AgdaSymbol{:}%
\>[15]\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
%
\>[2]\AgdaInductiveConstructor{TyApp}%
\>[12]\AgdaSymbol{:}%
\>[15]\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Kind}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
\>[0]\AgdaFunction{ren}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n'}\<%
\\
\>[0]\AgdaFunction{sub}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n'}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaDatatype{Kind}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\end{code}
\end{sourcepage}
\midrule
\begin{minipage}{\rightSize}
\begin{haskellcode}
data Kind
  = Star
  | Kind :=> Kind

data Type n
  = TyVar n
  | TyFun (Type n) (Type n)
  | TyForall Kind (Type (Maybe n))
  | TyLam (Type (Maybe n))
  | TyApp (Type n) (Type n) Kind

ren :: (n -> n') -> Type n -> Type n'
sub :: (n -> Type n') -> Type n -> Type n'
\end{haskellcode}
\end{minipage}
\resetVars
\end{frame}

\begin{frame}[fragile]{IOG use case: Laws}
\AgdaFunction{ren} is a \textit{functorial map} on \AgdaDatatype{Type}.
\begin{itemize}
\item \begin{code}[inline]%
\>[0]\AgdaFunction{ren-id}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ty}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ren}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{ty}\<%
\end{code}
\item \begin{code}[inline]%
\>[0]\AgdaFunction{ren-comp}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ty}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{n'}%
\>[39]\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{n''}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ren}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\end{code}
\end{itemize}
\pause
\AgdaFunction{sub} is a \textit{monadic bind} on \AgdaDatatype{Type}.
\begin{itemize}
\item \begin{code}[inline]%
\>[0]\AgdaFunction{sub-id}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{sub}\AgdaSpace{}%
\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{t}\<%
\end{code}
\item \begin{code}[inline]%
\>[0]\AgdaFunction{sub-var}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{x}\<%
\end{code}
\item \begin{code}[inline]%
\>[0]\AgdaFunction{sub-comp}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ty}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{σ'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n''}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{sub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\end{code}
\end{itemize}
\begin{code}[hide]%
\>[0]\AgdaComment{--\ extend\ a\ renaming\ by\ a\ bound\ variable}\<%
\\
\>[0]\AgdaFunction{ext}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaGeneralizable{n'}\<%
\\
\>[0]\AgdaFunction{ext}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaInductiveConstructor{Nothing}%
\>[15]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{Nothing}\<%
\\
\>[0]\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyLam}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{TyLam}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaFunction{ren}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{ext-cong}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(∀}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{ext-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaInductiveConstructor{Nothing}%
\>[23]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{ext-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[23]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(∀}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaBound{t}\<%
\\
\>[0]\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[30]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}%
\>[30]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[30]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyLam}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[30]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaInductiveConstructor{TyLam}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}%
\>[30]\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{ext-id}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ext}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{ext-id}\AgdaSpace{}%
\AgdaInductiveConstructor{Nothing}%
\>[16]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{ext-id}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{ren-id}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}%
\>[26]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{ren-id}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}%
\>[26]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-id}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-id}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ren-id}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[26]\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaFunction{ext-id}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-id}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{ren-id}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyLam}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[26]\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaInductiveConstructor{TyLam}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaFunction{ext-id}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-id}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{ren-id}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}%
\>[26]\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-id}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-id}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{ext-comp}%
\>[1772I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)(}\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSymbol{)(}\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{n''}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[1772I]%
\>[9]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ext}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ext-comp}\AgdaSpace{}%
\AgdaInductiveConstructor{Nothing}%
\>[18]\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{ext-comp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{ren-comp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[28]\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{ren-comp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}%
\>[28]\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-comp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-comp}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ren-comp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[28]\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{trans}%
\>[1832I]\AgdaSymbol{(}\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ext-comp}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[1832I]%
\>[9]\AgdaSymbol{(}\AgdaFunction{ren-comp}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaFunction{ren-comp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyLam}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[28]\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{TyLam}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{trans}%
\>[1851I]\AgdaSymbol{(}\AgdaFunction{ren-cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ext-comp}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[1851I]%
\>[9]\AgdaSymbol{(}\AgdaFunction{ren-comp}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaFunction{ren-comp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}%
\>[28]\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-comp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-comp}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{ρ'}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ |Extend\ type\ substitutions.}\<%
\\
\>[0]\AgdaFunction{exts}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{exts}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaInductiveConstructor{Nothing}%
\>[16]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaInductiveConstructor{Nothing}\<%
\\
\>[0]\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ren}\AgdaSpace{}%
\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ |Simultaneous\ substitution\ of\ type\ variables.}\<%
\\
\>[0]\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}%
\>[28]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{i}\<%
\\
\>[0]\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}%
\>[28]\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[28]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyLam}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[28]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{TyLam}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}%
\>[28]\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{COMPILE}\AgdaSpace{}%
\AgdaKeyword{AGDA2HS}\AgdaSpace{}%
\AgdaFunction{sub}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{exts-cong}%
\>[1960I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(∀}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[1960I]%
\>[10]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{exts-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaInductiveConstructor{Nothing}%
\>[21]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{exts-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren}\AgdaSpace{}%
\AgdaInductiveConstructor{Just}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{sub-cong}%
\>[1999I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(∀}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[1999I]%
\>[9]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaBound{ty}\<%
\\
\>[0]\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[30]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}%
\>[30]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[30]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyLam}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[30]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaInductiveConstructor{TyLam}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}%
\>[30]\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{exts-id}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{exts}\AgdaSpace{}%
\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{exts-id}\AgdaSpace{}%
\AgdaInductiveConstructor{Nothing}%
\>[17]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{exts-id}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{sub-id}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[26]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{sub-id}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}%
\>[26]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-id}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-id}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{sub-id}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[26]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaFunction{exts-id}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-id}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{sub-id}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyLam}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[26]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{TyLam}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaFunction{exts-id}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-id}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{sub-id}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}%
\>[26]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong2}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{sub-id}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{sub-id}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{sub-var}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{exts-ext}%
\>[2148I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)(}\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSymbol{)(}\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n''}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2148I]%
\>[9]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{exts}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{σ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{exts-ext}\AgdaSpace{}%
\AgdaInductiveConstructor{Nothing}%
\>[18]\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{exts-ext}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{sub-ren}%
\>[2183I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)(}\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSymbol{)(}\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n''}\AgdaSymbol{)}\<%
\\
\>[2183I][@{}l@{\AgdaIndent{0}}]%
\>[9]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{sub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{σ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{sub-ren}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[27]\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{sub-ren}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}%
\>[27]\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-ren}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-ren}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{sub-ren}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[27]\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{trans}%
\>[2234I]\AgdaSymbol{(}\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{exts-ext}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2234I]%
\>[9]\AgdaSymbol{(}\AgdaFunction{sub-ren}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaFunction{sub-ren}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyLam}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[27]\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{TyLam}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{trans}%
\>[2253I]\AgdaSymbol{(}\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{exts-ext}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2253I]%
\>[9]\AgdaSymbol{(}\AgdaFunction{sub-ren}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaFunction{sub-ren}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}%
\>[27]\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-ren}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-ren}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{ext-exts}%
\>[2289I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)(}\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSymbol{)(}\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{n''}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2289I]%
\>[9]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{exts}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{ren}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ext-exts}\AgdaSpace{}%
\AgdaInductiveConstructor{Nothing}%
\>[18]\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{ext-exts}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{trans}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-comp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaInductiveConstructor{Just}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{ren-comp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{ren-sub}%
\>[2336I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)(}\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSymbol{)(}\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{n''}\AgdaSymbol{)}\<%
\\
\>[2336I][@{}l@{\AgdaIndent{0}}]%
\>[9]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{sub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{ren}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ren-sub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[27]\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{ren-sub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}%
\>[27]\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-sub}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-sub}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{ren-sub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[27]\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{trans}%
\>[2388I]\AgdaSymbol{(}\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ext-exts}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2388I]%
\>[9]\AgdaSymbol{(}\AgdaFunction{ren-sub}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaFunction{ren-sub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyLam}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[27]\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{TyLam}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{trans}%
\>[2407I]\AgdaSymbol{(}\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{ext-exts}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2407I]%
\>[9]\AgdaSymbol{(}\AgdaFunction{ren-sub}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ext}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaFunction{ren-sub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}%
\>[27]\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-sub}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-sub}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{ρ}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{exts-comp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)(}\AgdaBound{σ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSymbol{)(}\AgdaBound{σ'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n'}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Type}\AgdaSpace{}%
\AgdaGeneralizable{n''}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[9]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{exts}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{sub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{exts-comp}\AgdaSpace{}%
\AgdaInductiveConstructor{Nothing}%
\>[22]\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{exts-comp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{trans}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ren-sub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaInductiveConstructor{Just}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{sub-ren}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{Just}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{sub-comp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyVar}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}%
\>[28]\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{sub-comp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSymbol{)}%
\>[28]\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaInductiveConstructor{TyFun}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-comp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-comp}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{sub-comp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[28]\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaInductiveConstructor{TyForall}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{trans}%
\>[2517I]\AgdaSymbol{(}\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{exts-comp}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2517I]%
\>[9]\AgdaSymbol{(}\AgdaFunction{sub-comp}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaFunction{sub-comp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyLam}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}%
\>[28]\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{TyLam}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{trans}%
\>[2536I]\AgdaSymbol{(}\AgdaFunction{sub-cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{exts-comp}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2536I]%
\>[9]\AgdaSymbol{(}\AgdaFunction{sub-comp}\AgdaSpace{}%
\AgdaBound{ty}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{exts}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaFunction{sub-comp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}%
\>[28]\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{cong2}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{TyApp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-comp}\AgdaSpace{}%
\AgdaBound{ty1}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sub-comp}\AgdaSpace{}%
\AgdaBound{ty2}\AgdaSpace{}%
\AgdaBound{σ}\AgdaSpace{}%
\AgdaBound{σ'}\AgdaSymbol{)}\<%
\end{code}
\resetVars
\end{frame}

\setbeamertemplate{headline}{\hfill\largeImg{agda2hs-qrcode}\hspace{0.2cm}\vspace{-4cm}}
\begin{frame}[fragile]{Implementation \hfill \alert{\small\texttt{https://github.com/agda/agda2hs}}}

\tikzset{
  every matrix/.style =
  { ampersand replacement = \&,
    matrix of nodes,
    nodes in empty cells },
  box/.style =
  { draw, rectangle,
    rounded corners = 1mm,
    minimum width  = 2cm,
    minimum height = 1cm },
  to/.style = {->, thick}
}

\begin{tikzpicture}
  \matrix (mat) [row sep = 1.1cm, every node/.style = {align=center}, font=\large] {
    \node (src) {\smallImg{agda}}; \\
    \node[box] (agda) {\textsc{Agda}}; \\
    \node[box] (trans) {\agdatohs}; \\
    \node (hs) {\smallImg{haskell}}; \\
  };
  \path
  (src)
    edge[to]
    node[right] {surface syntax}
  (agda) (agda)
    edge[to]
    node[left]  {\smallImg{agda}}
    node[right] {(type-checked) internal core representation}
  (trans) (trans)
    edge[to, color=mLightBrown]
    node[right] {}
  (hs)
  ;
\end{tikzpicture}

\end{frame}
\setbeamertemplate{headline}{}

\begin{frame}[fragile]{Implementation: \AgdaKeyword{where} clauses}

\begin{minipage}{.33\textwidth}%
\textbf{\underline{Surface}~~\smallImg{agda}}

\begin{code}[hide]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Ex1}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\end{code}
\begin{code}%
\>[0][@{}l@{\AgdaIndent{1}}]%
\>[2]\AgdaFunction{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Nat}\<%
\\
%
\>[2]\AgdaFunction{f}%
\>[2578I]\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{go}\<%
\\
\>[.][@{}l@{}]\<[2578I]%
\>[4]\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{go}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\<%
\\
%
\>[6]\AgdaFunction{go}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{TODO}\<%
\\
%
\>[6]\AgdaComment{--\ may\ use\ x}\<%
\end{code}
\end{minipage}
\midrule
\begin{minipage}{.33\textwidth}%
\textbf{\underline{Intermediate}~~\vspace{1pt}\smallImg{agda}}

\begin{code}[hide]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Ex2}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\end{code}
\begin{code}%
\>[0][@{}l@{\AgdaIndent{1}}]%
\>[2]\AgdaFunction{go}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Nat}\<%
\\
%
\>[2]\AgdaFunction{go}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{TODO}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Nat}\<%
\\
%
\>[2]\AgdaFunction{f}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{go}\AgdaSpace{}%
\AgdaBound{x}\<%
\end{code}
\end{minipage}
\midrule
\begin{minipage}{.33\textwidth}%
\begin{center}\textbf{\underline{Output}~~\smallImg{haskell}}\end{center}
\begin{minted}{haskell}
f :: Natural -> Natural
f x = go
  where
    go :: Natural
    go = TODO
\end{minted}
\end{minipage}
\resetVars
\end{frame}

\begin{frame}[fragile]{Correctness}

Is our translation \textbf{sound}?
\begin{enumerate}
\item Agda that typechecks produces valid Haskell
\item Translation preserves behaviour/semantics
\end{enumerate}
\pause
No formal proof \smallImg{sadface}
\begin{itemize}
\item Trust the ported Prelude and defined primitives
\item Ensure all dependent types appear under \textit{erased} positions
  \item enforced by the \agdatohs backend
\item Ensure source code also adheres to Haskell's naming conventions
  \begin{itemize}
  \item this check is actually relegated to GHC! \hspace{.5cm}\agdaHsLove{}
  \end{itemize}
\end{itemize}
\begin{alertblock}{NB}
total functions + strong normalisation $\Rightarrow$ evaluation order doesn't matter
\end{alertblock}
\end{frame}

\begin{frame}[fragile]{Future work}
Still many unsupported Haskell features:
\begin{itemize}
\item GADTs
\onslide<2->{\alert{$\sim$ covered by dependent types $\rightarrow$ identify subset}}
\item pattern guards, views
\onslide<2->{\alert{$\sim$ use \AgdaKeyword{with}-matching}}
\item 32-bit arithmetic
\onslide<2->{\alert{$\sim$ first add to Agda itself}}
\item Infinite data
\onslide<2->{\alert{$\sim$ coinductive types}}
\item Non-termination, general recursion
\onslide<2->{\alert{$\sim$ partiality/general monad}}
\end{itemize}
\onslide<3->{
Extra goodies:
\begin{itemize}
\item Generate \textbf{runtime checks} for decidable properties
\item \textbf{QuickCheck} postulated properties
\item \textsc{hs2agda}: inverse translation
$\Rightarrow$ streamline porting of \textbf{existing} libraries
\end{itemize}
}
\onslide<4->{
More \textbf{applications} $+$ \textbf{comparisons} with LiquidHaskell, \texttt{hs-to-coq}, etc..
}
\end{frame}

\setbeamertemplate{headline}{\hfill\largeImg{aim-qrcode}\hspace{0.2cm}\vspace{-6cm}}
\begin{frame}[fragile]{Shameless plug
\hfill \alert{\small\texttt{https://wiki.portal.chalmers.se/agda/Main/AIMXXXI}}}
\agdatohs was developed during the last two \textbf{Agda Implementors' Meetings}
\begin{itemize}
\item biannual event where Agda users of all levels hack on Agda, its ecosystem, etc..
\end{itemize}
\textbf{AIM XXXI} in Edinburgh November 10-16, will include:
\begin{itemize}
\item talks
\item code sprints
\item EuroProofNet day dedicated to the topic of large formal libraries
\item a hike along the Scottish seaside ~ \img{.9em}{whisky}
\end{itemize}
\pause
\begin{center}
\largeImg{join}
\end{center}
\end{frame}
\setbeamertemplate{headline}{}

\setbeamertemplate{headline}{\vfill\largeImg{agda2hs-qrcode}\hfill\largeImg{aim-qrcode}}
\begin{frame}[standout]
Questions?
\end{frame}
\setbeamertemplate{headline}{}

\end{document}
