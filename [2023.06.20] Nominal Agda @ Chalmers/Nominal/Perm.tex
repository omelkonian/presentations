\documentclass[main]{subfiles}
\begin{document}
\section*{Nominal/Perm.agda}
\begin{code}%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Init}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{SetAsType}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.DecEq}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Semigroup}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Monoid}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Group}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Setoid}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Nominal.Perm}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Atom}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{DecEq}\AgdaSpace{}%
\AgdaBound{Atom}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Nominal.Swap}\AgdaSpace{}%
\AgdaBound{Atom}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ **\ permutations}\<%
\\
\>[0]\AgdaFunction{Perm}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Atom}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaBound{Atom}\<%
\\
\>[0]\AgdaFunction{Perms}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaFunction{Perm}\<%
\\
\>[0]\AgdaComment{--\ SwapList\ implements\ Perms}\<%
\\
\>[0]\AgdaComment{--\ ???\ \ \ \ \ \ implements\ Perms}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ℓ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaBound{ℓ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Swap}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{permute}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Perm}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\>[2]\AgdaFunction{permute}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{uncurry}\AgdaSpace{}%
\AgdaField{swap}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{permute∗}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Perms}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\>[2]\AgdaFunction{permute∗}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{chain}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaFunction{permute}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{where}\AgdaSpace{}%
\AgdaFunction{chain}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{foldr}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘′\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaFunction{id}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{instance}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{Setoid-Perms}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{ISetoid}\AgdaSpace{}%
\AgdaFunction{Perms}\<%
\\
%
\>[4]\AgdaFunction{Setoid-Perms}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{.}\AgdaField{relℓ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{ℓ}\<%
\\
%
\>[6]\AgdaSymbol{.}\AgdaOperator{\AgdaField{\AgdaUnderscore{}≈\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≗\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{on}}\AgdaSpace{}%
\AgdaFunction{permute∗}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{Semigroup-Perms}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Semigroup}\AgdaSpace{}%
\AgdaFunction{Perms}\<%
\\
%
\>[4]\AgdaFunction{Semigroup-Perms}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaOperator{\AgdaField{\AgdaUnderscore{}◇\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}++\AgdaUnderscore{}}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaComment{--\ SemigroupLaws-Perms\ :\ SemigroupLaws≡\ Perms}\<%
\\
%
\>[4]\AgdaComment{--\ SemigroupLaws-Perms\ =\ record\ \{\ ◇-comm\ =\ \{!◇-comm!\}\ ;\ ◇-assocʳ\ =\ \{!!\}\ \}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{Monoid-Perms}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Monoid}\AgdaSpace{}%
\AgdaFunction{Perms}\<%
\\
%
\>[4]\AgdaFunction{Monoid-Perms}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{ε}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{MonoidLaws-Perms}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{MonoidLaws≡}\AgdaSpace{}%
\AgdaFunction{Perms}\<%
\\
%
\>[4]\AgdaFunction{MonoidLaws-Perms}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{MonoidLaws-List}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{Group-Perms}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Group}\AgdaSpace{}%
\AgdaFunction{Perms}\<%
\\
%
\>[4]\AgdaFunction{Group-Perms}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaOperator{\AgdaField{\AgdaUnderscore{}⁻¹}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{L.reverse}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaFunction{Product.swap}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{-}\<%
\\
\>[0]\AgdaComment{\ \ \ \ GroupLaws-Perms\ :\ GroupLaws\ Perms\ \AgdaUnderscore{}≈\AgdaUnderscore{}}\<%
\\
\>[0]\AgdaComment{\ \ \ \ GroupLaws-Perms\ =\ record\ \{inverse\ =\ invˡ\ ,\ invʳ;\ ⁻¹-cong\ =\ inv-cong\}}\<%
\\
\>[0]\AgdaComment{\ \ \ \ \ \ where}\<%
\\
\>[0]\AgdaComment{\ \ \ \ \ \ \ \ open\ Alg\ \AgdaUnderscore{}≈\AgdaUnderscore{}}\<%
\\
\>[0]\AgdaComment{\ \ \ \ \ \ \ \ --\ open\ Group\ Group-Perms}\<%
\\
\>[0]\<%
\\
\>[0]\AgdaComment{\ \ \ \ \ \ \ \ invˡ\ :\ LeftInverse\ []\ \AgdaUnderscore{}⁻¹\ \AgdaUnderscore{}++\AgdaUnderscore{}}\<%
\\
\>[0]\AgdaComment{\ \ \ \ \ \ \ \ invˡ\ []\ =\ λ\ \AgdaUnderscore{}\ →\ refl}\<%
\\
\>[0]\AgdaComment{\ \ \ \ \ \ \ \ invˡ\ (p\ ∷\ ps)}\<%
\\
\>[0]\AgdaComment{\ \ \ \ \ \ \ \ \ \ =\ \{!!\}}\<%
\\
\>[0]\<%
\\
\>[0]\AgdaComment{\ \ \ \ \ \ \ \ --\ rewrite\ invˡ\ ps\ x\ =\ \{!!\}}\<%
\\
\>[0]\<%
\\
\>[0]\AgdaComment{\ \ \ \ \ \ \ \ invʳ\ :\ RightInverse\ []\ \AgdaUnderscore{}⁻¹\ \AgdaUnderscore{}++\AgdaUnderscore{}}\<%
\\
\>[0]\AgdaComment{\ \ \ \ \ \ \ \ invʳ\ =\ \{!!\}}\<%
\\
\>[0]\<%
\\
\>[0]\AgdaComment{\ \ \ \ \ \ \ \ inv-cong\ :\ Congruent₁\ \AgdaUnderscore{}⁻¹}\<%
\\
\>[0]\AgdaComment{\ \ \ \ \ \ \ \ inv-cong\ =\ \{!!\}}\<%
\\
\>[0]\AgdaComment{-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{setoidA}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{ISetoid}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{SetoidLaws}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{SwapLaws}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Actionˡ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{swaps-++}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ps}\AgdaSpace{}%
\AgdaBound{ps′}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Perms}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{swaps}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ps}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaBound{ps′}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaField{≈}}\AgdaSpace{}%
\AgdaFunction{swaps}\AgdaSpace{}%
\AgdaBound{ps}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{swaps}\AgdaSpace{}%
\AgdaBound{ps′}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{swaps-++}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{≈-refl}\<%
\\
%
\>[4]\AgdaFunction{swaps-++}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{ps}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{cong-swap}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{swaps-++}\AgdaSpace{}%
\AgdaBound{ps}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{Perms-Action}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Actionˡ}\AgdaSpace{}%
\AgdaFunction{Perms}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\>[4]\AgdaFunction{Perms-Action}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{.}\AgdaOperator{\AgdaField{\AgdaUnderscore{}·\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{swaps}\<%
\\
%
\>[6]\AgdaSymbol{.}\AgdaField{identity}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{≈-refl}\<%
\\
%
\>[6]\AgdaSymbol{.}\AgdaField{compatibility}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ps}\AgdaSymbol{\}\{}\AgdaBound{ps′}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{≈-sym}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{swaps-++}\AgdaSpace{}%
\AgdaBound{ps}\AgdaSpace{}%
\AgdaBound{ps′}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaKeyword{instance}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{Perms-GSet}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{GSet}\AgdaSpace{}%
\AgdaFunction{Perms}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\>[6]\AgdaFunction{Perms-GSet}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{action}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Perms-Action}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{Perms-GSet′}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{GSet′}\AgdaSpace{}%
\AgdaFunction{Perms}\<%
\\
%
\>[4]\AgdaFunction{Perms-GSet′}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{.}\AgdaField{ℓₓ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{ℓ}\<%
\\
%
\>[6]\AgdaSymbol{.}\AgdaField{X}%
\>[10]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\>[6]\AgdaSymbol{.}\AgdaField{setoidX}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{setoidA}\<%
\\
%
\>[6]\AgdaSymbol{.}\AgdaField{action′}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Perms-Action}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{GSet-Morphisms}\AgdaSpace{}%
\AgdaFunction{Perms}\AgdaSpace{}%
\AgdaKeyword{public}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{equivariant}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaField{gset-equiv}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaComment{--\ equivariant\ maps\ betweens\ G-sets\ X\ and\ Y\ are\ denoted\ X\ —𝔾→\ Y.}\<%
\end{code}
\end{document}
