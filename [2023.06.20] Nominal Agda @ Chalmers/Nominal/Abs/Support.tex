\documentclass[main]{subfiles}
\begin{document}
\begin{frame}{Finitely supported \alert{abstractions}}
\begin{code}[hide]%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--allow-unsolved-metas}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Init}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{SetAsType}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{L.Mem}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.DecEq}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Setoid}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Bifunctor}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.InferenceRules}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.InfEnumerable}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Nominal.Abs.Support}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Atom}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚¶É}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{DecEq}\AgdaSpace{}%
\AgdaBound{Atom}\AgdaSpace{}%
\AgdaSymbol{‚¶Ñ}\AgdaSpace{}%
\AgdaSymbol{‚¶É}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Enumerable‚àû}\AgdaSpace{}%
\AgdaBound{Atom}\AgdaSpace{}%
\AgdaSymbol{‚¶Ñ}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Nominal.New}\AgdaSpace{}%
\AgdaBound{Atom}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Nominal.Swap}\AgdaSpace{}%
\AgdaBound{Atom}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Nominal.Support}\AgdaSpace{}%
\AgdaBound{Atom}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Nominal.Abs.Base}\AgdaSpace{}%
\AgdaBound{Atom}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaGeneralizable{‚Ñì}\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{‚¶É}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{ISetoid}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{‚¶Ñ}\AgdaSpace{}%
\AgdaSymbol{‚¶É}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{SetoidLaws}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{‚¶Ñ}\<%
\\
%
\>[2]\AgdaSymbol{‚¶É}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Swap}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{‚¶Ñ}\AgdaSpace{}%
\AgdaSymbol{‚¶É}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{SwapLaws}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{‚¶Ñ}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{‚âà-Reasoning}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaComment{--\ abstractions\ over\ finitely\ supported\ types\ are\ themselves\ finite}\<%
\end{code}
\begin{code}%
%
\>[2]\AgdaKeyword{instance}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{FinSupp-Abs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚¶É}\AgdaSpace{}%
\AgdaRecord{FinitelySupported}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{‚¶Ñ}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaRecord{FinitelySupported}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Abs}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{FinSupp-Abs}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{‚àÄfin}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{abs}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{let}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{‚àÄfin}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaKeyword{in}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{Œª}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaBound{y‚àâ}\AgdaSpace{}%
\AgdaBound{z‚àâ}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{‚¶Ö}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚Üî}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚¶Ü}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{abs}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{‚â°‚ü®‚ü©}}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaInductiveConstructor{abs}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{‚¶Ö}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚Üî}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚¶Ü}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{‚¶Ö}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚Üî}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚¶Ü}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{‚â°‚ü®}%
\>[126I]\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{‚óÜ}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaInductiveConstructor{abs}\AgdaSpace{}%
\AgdaBound{‚óÜ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{‚¶Ö}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚Üî}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚¶Ü}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{))}\<%
\\
\>[126I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{swap-noop}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaKeyword{where}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüò}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{z‚àâ}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüò}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{y‚àâ}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüò}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{‚ü©}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaInductiveConstructor{abs}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{‚¶Ö}}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚Üî}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚¶Ü}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{‚âà‚ü®}\AgdaSpace{}%
\AgdaFunction{cong-abs}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{z}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{y‚àâ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaInductiveConstructor{there}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{z‚àâ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚àò}}\AgdaSpace{}%
\AgdaInductiveConstructor{there}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{‚ü©}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaInductiveConstructor{abs}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{t}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{‚àé}}\AgdaSpace{}%
\AgdaKeyword{where}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{‚âà-Reasoning}\<%
\end{code}
\begin{code}[hide]%
%
\>[2]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{‚¶É}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{FinitelySupported}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{‚¶Ñ}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaComment{--\ Two\ ways\ to\ fix\ functoriality:}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaComment{--\ 1.\ require\ that\ (f\ :\ A\ ‚Üí\ A)\ is\ equivariant}\<%
\\
%
\>[4]\AgdaComment{--\ \ \ 2.\ ...or\ that\ it\ at\ least\ has\ finite\ support}\<%
\\
%
\>[4]\AgdaFunction{mapAbs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Op‚ÇÅ}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaFunction{Op‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Abs}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaComment{--\ ‚âà\ (A\ ‚Üí\ A)\ ‚Üí\ (Abs\ A\ ‚Üí\ Abs\ A)}\<%
\\
%
\>[4]\AgdaComment{--\ T0D0:\ In\ order\ to\ resolve\ termination\ issues\ (via\ well-founded\ recursion),}\<%
\\
%
\>[4]\AgdaComment{--\ we\ need\ a\ more\ restrainted\ version\ of\ mapAbs\ with\ type:}\<%
\\
%
\>[4]\AgdaComment{--\ mapAbs\ :\ (x'\ :\ Abs\ A)\ ‚Üí\ (f\ :\ (a\ :\ A)\ ‚Üí\ a\ ‚â∫\ f\ ‚Üí\ A)\ ‚Üí\ Abs\ A}\<%
\\
%
\>[4]\AgdaComment{--\ NB:\ a\ generalisation\ would\ be\ to\ say\ that\ the\ size\ behaviour\ of}\<%
\\
%
\>[4]\AgdaComment{--\ \ \ \ \ `mapAbs\ f`\ corresponds\ to\ that\ of\ `f`}\<%
\\
%
\>[4]\AgdaFunction{mapAbs}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{x'}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fresh-var}\AgdaSpace{}%
\AgdaBound{x'}\AgdaSpace{}%
\AgdaComment{--\ T0D0:\ ++\ supp??\ f}\<%
\\
%
\>[6]\AgdaKeyword{in}\AgdaSpace{}%
\AgdaInductiveConstructor{abs}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{conc}\AgdaSpace{}%
\AgdaBound{x'}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{freshen}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Op‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Abs}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{freshen}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{@(}\AgdaInductiveConstructor{abs}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaKeyword{let}%
\>[215I]\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{‚àÄfin}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
\>[.][@{}l@{}]\<[215I]%
\>[10]\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{b‚àâ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{minFresh}\AgdaSpace{}%
\AgdaBound{xs}\<%
\\
%
\>[6]\AgdaKeyword{in}\AgdaSpace{}%
\AgdaInductiveConstructor{abs}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{conc}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{b}\AgdaSymbol{)}\<%
\\
\>[0]\<%
\end{code}
\end{frame}
\end{document}
