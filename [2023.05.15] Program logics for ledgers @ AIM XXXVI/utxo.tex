\documentclass[main]{subfiles}
\begin{document}
\begin{frame}[fragile]{UTxO: Barebones Setup}
\begin{code}[hide]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Init}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{SetAsType}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{L.Mem}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}─\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.General}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Maybes}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.DecEq}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Decidable}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.ToN}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Lists}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⁉\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}‼\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{map↦}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↦\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Lists.Dec}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Lists.WithK}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Functor}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Applicative}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.FromList}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Membership}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}∈?\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∉?\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Irrelevance}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}─\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Apartness}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Maps}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{Map}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊣\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Monad}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.InferenceRules}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Common}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{TxOutputRef}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{constructor}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}indexed-at\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaKeyword{field}%
\>[63I]\AgdaField{txId}%
\>[14]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{HashId}\<%
\\
\>[.][@{}l@{}]\<[63I]%
\>[8]\AgdaField{index}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{TxOutputRef}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
\>[0]\AgdaKeyword{unquoteDecl}\AgdaSpace{}%
\AgdaFunction{DecEq-TxOR}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaMacro{DERIVE}\AgdaSpace{}%
\AgdaRecord{DecEq}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaKeyword{quote}\AgdaSpace{}%
\AgdaRecord{TxOutputRef}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{DecEq-TxOR}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{CommonInfo}\AgdaSpace{}%
\AgdaRecord{TxOutputRef}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{postulate}\AgdaSpace{}%
\AgdaPostulate{TODO}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaGeneralizable{ℓ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{K}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{DecEq}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{DecEq}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.ToList}\<%
\\
%
\>[2]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Sets}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{S}\<%
\\
%
\>[2]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Bags}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{B}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}‼\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{K}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Map⟨}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaRecord{↦}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaRecord{⟩}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∈ᵈ}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{V}\<%
\\
%
\>[2]\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‼}}\AgdaSpace{}%
\AgdaBound{k∈}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{destruct-Is-just}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{∈ᵈ⇒⁉}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{k∈}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{proj₁}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}─ᵏˢ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Map⟨}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaRecord{↦}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaRecord{⟩}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Map⟨}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaRecord{↦}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaRecord{⟩}\<%
\\
%
\>[2]\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{─ᵏˢ}}\AgdaSpace{}%
\AgdaBound{ks}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{filterK}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∉?}}\AgdaSpace{}%
\AgdaBound{ks}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{m}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}─\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}─ᵏˢ\AgdaUnderscore{}}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{keys}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Map⟨}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaRecord{↦}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaRecord{⟩}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaBound{K}\<%
\\
%
\>[2]\AgdaFunction{keys}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaField{toList}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{keysˢ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Map⟨}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaRecord{↦}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaRecord{⟩}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{B.Bag⟨}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaRecord{⟩}\<%
\\
%
\>[2]\AgdaFunction{keysˢ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{fromList}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{keys}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{values⊑}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Map⟨}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaRecord{↦}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaRecord{⟩}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{∃}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∈ᵈ}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaBound{V}\<%
\\
%
\>[2]\AgdaFunction{values⊑}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ks}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ks⊆}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{mapWith∈}\AgdaSpace{}%
\AgdaBound{ks}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‼\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{L.All.lookup}\AgdaSpace{}%
\AgdaBound{ks⊆}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{values}\AgdaSpace{}%
\AgdaFunction{values′}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Map⟨}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaRecord{↦}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaRecord{⟩}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaBound{V}\<%
\\
%
\>[2]\AgdaFunction{values}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaField{toList}\<%
\\
%
\>[2]\AgdaFunction{values′}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{values⊑}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{keys}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{L.All.tabulate}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{values⊑ˢ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Map⟨}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaRecord{↦}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaRecord{⟩}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{∃}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∈ᵈ}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{B.Bag⟨}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaRecord{⟩}\<%
\\
%
\>[2]\AgdaFunction{values⊑ˢ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{fromList}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘₂}}\AgdaSpace{}%
\AgdaFunction{values⊑}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{valuesˢ}\AgdaSpace{}%
\AgdaFunction{valuesˢ′}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Map⟨}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaRecord{↦}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaRecord{⟩}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{B.Bag⟨}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaRecord{⟩}\<%
\\
%
\>[2]\AgdaFunction{valuesˢ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{fromList}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaField{toList}\<%
\\
%
\>[2]\AgdaFunction{valuesˢ′}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{values⊑ˢ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{keys}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{L.All.tabulate}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{≡-Reasoning}\<%
\\
%
\>[2]\AgdaKeyword{private}\AgdaSpace{}%
\AgdaKeyword{variable}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaGeneralizable{m}\AgdaSpace{}%
\AgdaGeneralizable{m′}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Map⟨}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaRecord{↦}\AgdaSpace{}%
\AgdaBound{V}\AgdaSpace{}%
\AgdaRecord{⟩}\<%
\\
%
\>[4]\AgdaGeneralizable{ks}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaBound{K}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaGeneralizable{kvs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{K}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaBound{V}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Lists.Dec}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Apartness}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{--\ basic\ list\ properties}\<%
\\
%
\>[2]\AgdaKeyword{postulate}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaPostulate{nubBy-from∘to}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{DecEq}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaDatatype{Unique}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{nubBy}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{xs}\<%
\\
%
\>[4]\AgdaPostulate{Unique-proj₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xys}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaDatatype{Unique}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{xys}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Unique}\AgdaSpace{}%
\AgdaBound{xys}\<%
\\
%
\>[4]\AgdaPostulate{Disjoint-proj₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xys}\AgdaSpace{}%
\AgdaBound{xys′}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{xys}\AgdaSpace{}%
\AgdaOperator{\AgdaField{♯}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{xys′}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{xys}\AgdaSpace{}%
\AgdaOperator{\AgdaField{♯}}\AgdaSpace{}%
\AgdaBound{xys′}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{nub∘nubBy-from∘to}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{DecEq}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{DecEq}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{\{}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
%
\>[4]\AgdaDatatype{Unique}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{nub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nubBy}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{xs}\<%
\\
%
\>[2]\AgdaFunction{nub∘nubBy-from∘to}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{f}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{\}\{}\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{uniq}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{nub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nubBy}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{nub-from∘to}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{Unique-nubBy}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{nubBy}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{xs}\<%
\\
%
\>[4]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaPostulate{nubBy-from∘to}\AgdaSpace{}%
\AgdaBound{uniq}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaBound{xs}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{toList-∪}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{keys}\AgdaSpace{}%
\AgdaGeneralizable{m}\AgdaSpace{}%
\AgdaOperator{\AgdaField{♯}}\AgdaSpace{}%
\AgdaFunction{keys}\AgdaSpace{}%
\AgdaGeneralizable{m′}\AgdaSpace{}%
\AgdaSymbol{→}%
\>[33]\AgdaField{toList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∪}}\AgdaSpace{}%
\AgdaGeneralizable{m′}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaGeneralizable{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaGeneralizable{m′}\<%
\\
%
\>[2]\AgdaFunction{toList-∪}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{@(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{Map.⊣}}\AgdaSpace{}%
\AgdaBound{·uniq-m}\AgdaSymbol{)\}\{}\AgdaBound{m′}\AgdaSymbol{@(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{Map.⊣}}\AgdaSpace{}%
\AgdaBound{·uniq-m′}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaBound{m♯m′}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaField{toList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∪}}\AgdaSpace{}%
\AgdaBound{m′}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{≡⟨⟩}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{nub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nubBy}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m′}\AgdaSymbol{))}\<%
\\
%
\>[4]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaFunction{nub}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaPostulate{nubBy-from∘to}\AgdaSpace{}%
\AgdaFunction{uniq-proj₁-++}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{nub}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m′}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{nub-from∘to}\AgdaSpace{}%
\AgdaFunction{uniq-++}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m′}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[4]\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{uniq-m}%
\>[14]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{recompute}\AgdaSpace{}%
\AgdaField{dec}\AgdaSpace{}%
\AgdaBound{·uniq-m}\<%
\\
%
\>[6]\AgdaFunction{uniq-m′}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{recompute}\AgdaSpace{}%
\AgdaField{dec}\AgdaSpace{}%
\AgdaBound{·uniq-m′}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[6]\AgdaFunction{uniq-++}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Unique}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m′}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{uniq-++}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{L.Uniq.++⁺}%
\>[514I]\AgdaSymbol{(}\AgdaPostulate{Unique-proj₁}\AgdaSpace{}%
\AgdaFunction{uniq-m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{Unique-proj₁}\AgdaSpace{}%
\AgdaFunction{uniq-m′}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[514I]%
\>[27]\AgdaSymbol{(}\AgdaPostulate{Disjoint-proj₁}\AgdaSpace{}%
\AgdaBound{m♯m′}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[6]\AgdaFunction{uniq-proj₁-++}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Unique}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m′}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{uniq-proj₁-++}\AgdaSpace{}%
\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{L.map-++-commute}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m′}\AgdaSymbol{)}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{L.Uniq.++⁺}\AgdaSpace{}%
\AgdaFunction{uniq-m}\AgdaSpace{}%
\AgdaFunction{uniq-m′}\AgdaSpace{}%
\AgdaBound{m♯m′}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{m′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m♯m′}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{keys}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaField{♯}}\AgdaSpace{}%
\AgdaFunction{keys}\AgdaSpace{}%
\AgdaBound{m′}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{valuesˢ-∪}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{valuesˢ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∪}}\AgdaSpace{}%
\AgdaBound{m′}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{valuesˢ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{B.∪}}\AgdaSpace{}%
\AgdaFunction{valuesˢ}\AgdaSpace{}%
\AgdaBound{m′}\<%
\\
%
\>[4]\AgdaFunction{valuesˢ-∪}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{valuesˢ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∪}}\AgdaSpace{}%
\AgdaBound{m′}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{≡⟨⟩}}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaField{fromList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<\$>}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∪}}\AgdaSpace{}%
\AgdaBound{m′}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{fromList}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{toList-∪}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}\{}\AgdaBound{m′}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{m♯m′}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaField{fromList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<\$>}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m′}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{fromList}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{L.map-++-commute}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m′}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaField{fromList}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<\$>}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<\$>}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m′}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{≡⟨⟩}}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaField{fromList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<\$>}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{B.∪}}\AgdaSpace{}%
\AgdaField{fromList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<\$>}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m′}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{≡⟨⟩}}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{valuesˢ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{B.∪}}\AgdaSpace{}%
\AgdaFunction{valuesˢ}\AgdaSpace{}%
\AgdaBound{m′}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{valuesˢ∘fromList}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Unique}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<\$>}}\AgdaSpace{}%
\AgdaGeneralizable{kvs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{valuesˢ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{fromList}\AgdaSpace{}%
\AgdaGeneralizable{kvs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaField{fromList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<\$>}}\AgdaSpace{}%
\AgdaGeneralizable{kvs}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{valuesˢ∘fromList}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{fromList}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{nub∘nubBy-from∘to}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{valuesˢ-─}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{∃}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∈ᵈ}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{valuesˢ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{─ᵏˢ}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{proj₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{valuesˢ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{B.─}}\AgdaSpace{}%
\AgdaFunction{values⊑ˢ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
%
\>[2]\AgdaFunction{valuesˢ-─}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ks}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ks⊆}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{valuesˢ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{─ᵏˢ}}\AgdaSpace{}%
\AgdaBound{ks}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{≡⟨⟩}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaField{fromList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<\$>}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{─ᵏˢ}}\AgdaSpace{}%
\AgdaBound{ks}\AgdaSymbol{))}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{≡⟨⟩}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaField{fromList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<\$>}}\AgdaSpace{}%
\AgdaFunction{filter}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∉?}}\AgdaSpace{}%
\AgdaBound{ks}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\<%
\\
%
\>[4]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{fromList}\AgdaSpace{}%
\AgdaPostulate{H}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaField{fromList}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∸[bag]}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{mapWith∈}\AgdaSpace{}%
\AgdaBound{ks}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‼\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{L.All.lookup}\AgdaSpace{}%
\AgdaBound{ks⊆}\AgdaSymbol{)))}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{≡⟨⟩}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaField{fromList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<\$>}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{B.─}}\<%
\\
%
\>[6]\AgdaField{fromList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{mapWith∈}\AgdaSpace{}%
\AgdaBound{ks}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‼\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{L.All.lookup}\AgdaSpace{}%
\AgdaBound{ks⊆}\AgdaSymbol{))}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{≡⟨⟩}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaField{fromList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{<\$>}}\AgdaSpace{}%
\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{B.─}}\AgdaSpace{}%
\AgdaField{fromList}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{values⊑}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{-,}}\AgdaSpace{}%
\AgdaBound{ks⊆}\AgdaSymbol{))}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{≡⟨⟩}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{valuesˢ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{B.─}}\AgdaSpace{}%
\AgdaFunction{values⊑ˢ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{-,}}\AgdaSpace{}%
\AgdaBound{ks⊆}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{∎}}\<%
\\
%
\>[4]\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaKeyword{postulate}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaPostulate{H}%
\>[730I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{filter}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∉?}}\AgdaSpace{}%
\AgdaBound{ks}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\<%
\\
\>[.][@{}l@{}]\<[730I]%
\>[10]\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{toList}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∸[bag]}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{mapWith∈}\AgdaSpace{}%
\AgdaBound{ks}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‼\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{L.All.lookup}\AgdaSpace{}%
\AgdaBound{ks⊆}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{postulate}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaPostulate{values⊆⇒⊆[bag]}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{∃}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∈ᵈ}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{values⊑}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊆[bag]}}\AgdaSpace{}%
\AgdaFunction{values}\AgdaSpace{}%
\AgdaBound{m}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{values⊆⇒⊆ˢ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{∃}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∈ᵈ}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{values⊑ˢ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{B.⊆ˢ}}\AgdaSpace{}%
\AgdaFunction{valuesˢ}\AgdaSpace{}%
\AgdaBound{m}\<%
\\
%
\>[2]\AgdaFunction{values⊆⇒⊆ˢ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{values⊆⇒⊆[bag]}\<%
\end{code}
\begin{code}%
\>[0]\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaRecord{Map⟨}\AgdaSpace{}%
\AgdaRecord{TxOutputRef}\AgdaSpace{}%
\AgdaRecord{↦}\AgdaSpace{}%
\AgdaRecord{TxOutput}\AgdaSpace{}%
\AgdaRecord{⟩}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{mkUtxo}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{out}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{out}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{L.Mem.∈}}\AgdaSpace{}%
\AgdaPostulate{outputs}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{TxOutputRef}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaRecord{TxOutput}\<%
\\
\>[0]\AgdaFunction{mkUtxo}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{out}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{out∈}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{♯}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{indexed-at}}\AgdaSpace{}%
\AgdaField{toℕ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{L.Any.index}\AgdaSpace{}%
\AgdaBound{out∈}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{out}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{postulate}\AgdaSpace{}%
\AgdaPostulate{Unique-mkUtxo}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Unique}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{mapWith∈}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaPostulate{outputs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{mkUtxo}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{utxoTx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Tx}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{S}\<%
\\
\>[0]\AgdaFunction{utxoTx}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{fromList}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{L.Mem.mapWith∈}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaPostulate{outputs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{mkUtxo}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\<%
\end{code}
\vspace{-.5cm}
\begin{AgdaMultiCode}
\begin{code}%
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{IsValidTx}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Tx}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{utxos}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{field}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaField{noDoubleSpending}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{·Unique}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{outputRefs}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaField{validOutputRefs}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{∀[}\AgdaSpace{}%
\AgdaBound{ref}\AgdaSpace{}%
\AgdaFunction{∈}\AgdaSpace{}%
\AgdaPostulate{outputRefs}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ref}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∈ᵈ}}\AgdaSpace{}%
\AgdaBound{utxos}\AgdaSymbol{)}\<%
\end{code}
\begin{code}[hide]%
%
\>[2]\AgdaBound{resolved}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Resolved}\AgdaSpace{}%
\AgdaBound{tx}\<%
\\
%
\>[2]\AgdaBound{resolved}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{utxos}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‼\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{L.All.lookup}\AgdaSpace{}%
\AgdaField{validOutputRefs}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaBound{txInfo}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{mkTxInfo}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{resolved}\<%
\\
%
\>[2]\AgdaBound{resolvedInputs}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{resolveInputs}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{resolved}\<%
\\
%
\>[2]\AgdaKeyword{field}\<%
\end{code}
\begin{code}%
\>[2][@{}l@{\AgdaIndent{1}}]%
\>[4]\AgdaField{preservesValues}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaPostulate{forge}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+}}\AgdaSpace{}%
\AgdaFunction{∑}\AgdaSpace{}%
\AgdaBound{resolvedInputs}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{value}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{∑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaPostulate{outputs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaField{value}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaField{allInputsValidate}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{∀[}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaFunction{∈}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaPostulate{inputs}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaFunction{T}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaPostulate{validator}\AgdaSpace{}%
\AgdaBound{txInfo}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaPostulate{redeemer}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaField{validateValidHashes}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{∀[}\AgdaSpace{}%
\AgdaBound{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{o}\AgdaBound{)}\AgdaSpace{}%
\AgdaFunction{∈}\AgdaSpace{}%
\AgdaBound{resolvedInputs}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{o}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{address}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaPostulate{validator}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{♯}}\AgdaSymbol{)}\<%
\end{code}
\end{AgdaMultiCode}
\end{frame}
\begin{frame}[fragile]{UTxO: Denotational Semantics}
\begin{code}[hide]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{IsValidTx}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{postulate}\AgdaSpace{}%
\AgdaPostulate{isValidTx?}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Dec}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{IsValidTx}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{isValidTx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Tx}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{isValidTx}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⌊}}\AgdaSpace{}%
\AgdaPostulate{isValidTx?}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⌋}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{variable}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaGeneralizable{s′}\AgdaSpace{}%
\AgdaGeneralizable{s″}\AgdaSpace{}%
\AgdaGeneralizable{s₁}\AgdaSpace{}%
\AgdaGeneralizable{s₁′}\AgdaSpace{}%
\AgdaGeneralizable{s₁″}\AgdaSpace{}%
\AgdaGeneralizable{s₂}\AgdaSpace{}%
\AgdaGeneralizable{s₂′}\AgdaSpace{}%
\AgdaGeneralizable{s₂″}\AgdaSpace{}%
\AgdaGeneralizable{s₃}\AgdaSpace{}%
\AgdaGeneralizable{s₃′}\AgdaSpace{}%
\AgdaGeneralizable{s₃″}\AgdaSpace{}%
\AgdaGeneralizable{s₂₃}\AgdaSpace{}%
\AgdaGeneralizable{s₂₃′}\AgdaSpace{}%
\AgdaGeneralizable{s₂₃″}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{S}\<%
\\
%
\>[2]\AgdaGeneralizable{t}\AgdaSpace{}%
\AgdaGeneralizable{t′}\AgdaSpace{}%
\AgdaGeneralizable{t″}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Tx}\<%
\\
%
\>[2]\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaGeneralizable{l″}\AgdaSpace{}%
\AgdaGeneralizable{l₁}\AgdaSpace{}%
\AgdaGeneralizable{l₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{L}\<%
\\
%
\>[2]\AgdaGeneralizable{ls}\AgdaSpace{}%
\AgdaGeneralizable{ls′}\AgdaSpace{}%
\AgdaGeneralizable{ls″}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{L}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaFunction{S}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaGeneralizable{ms}\AgdaSpace{}%
\AgdaGeneralizable{ms′}\AgdaSpace{}%
\AgdaGeneralizable{ms″}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaFunction{S}\<%
\\
%
\>[2]\AgdaGeneralizable{mls}\AgdaSpace{}%
\AgdaGeneralizable{mls′}\AgdaSpace{}%
\AgdaGeneralizable{mls″}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{L}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ **\ Denotational\ semantics}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{Domain}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaFunction{S}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{Denotable}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{field}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Domain}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Denotable}\AgdaSpace{}%
\AgdaSymbol{⦃...⦄}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{Domain₀}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{S}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{Denotable₀}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{field}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧₀}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Domain₀}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Denotable₀}\AgdaSpace{}%
\AgdaSymbol{⦃...⦄}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{instance}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{⟦T⟧₀}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Denotable₀}\AgdaSpace{}%
\AgdaPostulate{Tx}\<%
\\
%
\>[2]\AgdaFunction{⟦T⟧₀}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧₀}}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{utxos}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{utxos}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{─ᵏˢ}}\AgdaSpace{}%
\AgdaPostulate{outputRefs}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∪}}\AgdaSpace{}%
\AgdaFunction{utxoTx}\AgdaSpace{}%
\AgdaBound{tx}\<%
\end{code}
\begin{code}%
\>[0]\AgdaKeyword{instance}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{⟦T⟧}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Denotable}\AgdaSpace{}%
\AgdaPostulate{Tx}\<%
\\
%
\>[2]\AgdaFunction{⟦T⟧}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧}}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{M.when}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{isValidTx}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{─}}\AgdaSpace{}%
\AgdaPostulate{outputRefs}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∪}}\AgdaSpace{}%
\AgdaFunction{utxoTx}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{⟦L⟧}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Denotable}\AgdaSpace{}%
\AgdaPostulate{L}\<%
\\
%
\>[2]\AgdaFunction{⟦L⟧}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}%
\>[19]\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
%
\>[2]\AgdaFunction{⟦L⟧}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>=>}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\<%
\end{code}
\begin{code}[hide]%
%
\>[2]\AgdaFunction{⟦L⟧₀}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Denotable₀}\AgdaSpace{}%
\AgdaPostulate{L}\<%
\\
%
\>[2]\AgdaFunction{⟦L⟧₀}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧₀}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}%
\>[21]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{id}\<%
\\
%
\>[2]\AgdaFunction{⟦L⟧₀}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧₀}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{comp₀}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{comp₀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}%
\>[18]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{comp₀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{comp₀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\<%
\end{code}
\begin{code}%
\>[0]\AgdaFunction{comp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>=>}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{comp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}%
\>[17]\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{comp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{nothing}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{s}%
\>[14]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{comp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{s}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaComment{--\ valid\ ledgers\ w.r.t.\ a\ given\ initial\ state}\<%
\\
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{VL}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{L}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VL}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
%
\>[2]\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊣\AgdaUnderscore{}∷\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaRecord{IsValidTx}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaGeneralizable{s}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{∙}}%
\>[1204I]\AgdaDatatype{VL}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaGeneralizable{l}\<%
\\
\>[.][@{}l@{}]\<[1204I]%
\>[6]\AgdaOperator{\AgdaFunction{────────────────}}\<%
\\
%
\>[6]\AgdaDatatype{VL}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{VL⇒Resolved}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{VL}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaPostulate{Resolved}\AgdaSpace{}%
\AgdaGeneralizable{l}\<%
\\
\>[0]\AgdaFunction{VL⇒Resolved}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[0]\AgdaFunction{VL⇒Resolved}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{tx}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊣}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{resolved}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaFunction{VL⇒Resolved}\AgdaSpace{}%
\AgdaBound{l}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ **\ Operational\ semantics}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}—→\AgdaUnderscore{}}}\<%
\\
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}—→\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{L}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{base}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaOperator{\AgdaFunction{───────────}}\<%
\\
%
\>[4]\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaInductiveConstructor{step}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaRecord{IsValidTx}\AgdaSpace{}%
\AgdaGeneralizable{t}\AgdaSpace{}%
\AgdaGeneralizable{s}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{∙}}%
\>[1257I]\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{t}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
\>[.][@{}l@{}]\<[1257I]%
\>[6]\AgdaOperator{\AgdaFunction{──────────────────}}\<%
\\
%
\>[6]\AgdaGeneralizable{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{oper-comp}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaGeneralizable{l}%
\>[12]\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}%
\>[17]\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}%
\>[1275I]\AgdaGeneralizable{l′}%
\>[12]\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s′}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s″}\<%
\\
\>[.][@{}l@{}]\<[1275I]%
\>[4]\AgdaOperator{\AgdaFunction{──────────────────}}\<%
\\
%
\>[4]\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}%
\>[17]\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s″}\<%
\\
\>[0]\AgdaFunction{oper-comp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}%
\>[22]\AgdaInductiveConstructor{base}%
\>[40]\AgdaBound{s′→s″}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{s′→s″}\<%
\\
\>[0]\AgdaFunction{oper-comp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{step}\AgdaSpace{}%
\AgdaBound{valid}\AgdaSpace{}%
\AgdaBound{s→s′}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s′→s″}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{step}\AgdaSpace{}%
\AgdaBound{valid}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{oper-comp}\AgdaSpace{}%
\AgdaBound{s→s′}\AgdaSpace{}%
\AgdaBound{s′→s″}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ **\ Relating\ denotational\ and\ operational\ semantics.}\<%
\\
\>[0]\AgdaFunction{denot⇒oper}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{─────────────────}}\<%
\\
%
\>[2]\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
\>[0]\AgdaFunction{denot⇒oper}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{base}\<%
\\
\>[0]\AgdaFunction{denot⇒oper}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{l≡}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{valid}\ ←\ \AgdaPostulate{isValidTx?}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
%
\>[2]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{step}\AgdaSpace{}%
\AgdaBound{valid}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{denot⇒oper}\AgdaSpace{}%
\AgdaBound{l≡}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{oper⇒denot}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{─────────────────}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
\>[0]\AgdaFunction{oper⇒denot}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaInductiveConstructor{[]}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaInductiveConstructor{base}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{oper⇒denot}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{step}\AgdaSpace{}%
\AgdaBound{valid}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{dec-yes}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{isValidTx?}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{valid}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{proj₂}\<%
\\
%
\>[2]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{oper⇒denot}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{denot⇔oper}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{═════════════════}}\<%
\\
%
\>[2]\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
\>[0]\AgdaFunction{denot⇔oper}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{denot⇒oper}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{oper⇒denot}\<%
\end{code}
\end{frame}
\begin{frame}{UTxO: Separation via Disjointness}
\begin{code}[hide]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}[\AgdaUnderscore{}↦\AgdaUnderscore{}]∅}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{TxOutputRef}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{TxOutput}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
\>[0]\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↦}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]∅}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↦}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{k′}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{k′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≢}}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{k′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∉ᵈ}}\AgdaSpace{}%
\AgdaBound{m}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{Assertion}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Pred₀}\AgdaSpace{}%
\AgdaFunction{S}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{variable}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaGeneralizable{P′}\AgdaSpace{}%
\AgdaGeneralizable{P₁}\AgdaSpace{}%
\AgdaGeneralizable{P₂}\AgdaSpace{}%
\AgdaGeneralizable{Q}\AgdaSpace{}%
\AgdaGeneralizable{Q′}\AgdaSpace{}%
\AgdaGeneralizable{Q₁}\AgdaSpace{}%
\AgdaGeneralizable{Q₂}\AgdaSpace{}%
\AgdaGeneralizable{R}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Assertion}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{private}\AgdaSpace{}%
\AgdaKeyword{variable}\AgdaSpace{}%
\AgdaGeneralizable{K}\AgdaSpace{}%
\AgdaGeneralizable{V₁}\AgdaSpace{}%
\AgdaGeneralizable{V₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{emp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Assertion}\<%
\\
\>[0]\AgdaFunction{emp}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∉ᵈ}}\AgdaSpace{}%
\AgdaBound{m}\<%
\end{code}
\begin{code}%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∗\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Op₂}\AgdaSpace{}%
\AgdaFunction{Assertion}\<%
\\
\>[0]\AgdaSymbol{(}\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∗}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{∃}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{∃}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊎}}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩≡}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaBound{s₂}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↦\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{TxOutputRef}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{TxOutput}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Assertion}\<%
\\
\>[0]\AgdaBound{or}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↦}}\AgdaSpace{}%
\AgdaBound{o}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}[}}\AgdaSpace{}%
\AgdaBound{or}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↦}}\AgdaSpace{}%
\AgdaBound{o}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]∅}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{infixr}\AgdaSpace{}%
\AgdaNumber{10}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∗\AgdaUnderscore{}}}\<%
\\
\>[0]\AgdaKeyword{infix}%
\>[7]\AgdaNumber{11}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↦\AgdaUnderscore{}}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ **\ Hoare\ triples.}\<%
\\
\>[0]\AgdaFunction{weak↑}\AgdaSpace{}%
\AgdaFunction{strong↑}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred₀}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Pred₀}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{weak↑}%
\>[8]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{M.All.All}\<%
\\
\>[0]\AgdaFunction{strong↑}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{M.Any.Any}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{infixl}\AgdaSpace{}%
\AgdaNumber{4}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↑∘\AgdaUnderscore{}}}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↑∘\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred₀}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Pred₀}\AgdaSpace{}%
\AgdaFunction{S}\<%
\\
\>[0]\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{strong↑}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{lift↑}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{strong↑}\<%
\\
\>[0]\AgdaKeyword{pattern}\AgdaSpace{}%
\AgdaInductiveConstructor{ret↑}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{M.Any.just}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{map↑}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊆¹}}\AgdaSpace{}%
\AgdaGeneralizable{Q}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{lift↑}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊆¹}}\AgdaSpace{}%
\AgdaFunction{lift↑}\AgdaSpace{}%
\AgdaGeneralizable{Q}\<%
\\
\>[0]\AgdaFunction{map↑}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{M.Any.map}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}⟨\AgdaUnderscore{}⟩}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Assertion}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{L}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Assertion}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊢}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}⟨\AgdaUnderscore{}⟩＠\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Assertion}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{L}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Assertion}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩＠}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{hoare-base}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{──────────────}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[0]\AgdaFunction{hoare-base}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ret↑}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{lift∘>>=}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ms}\AgdaSymbol{\}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{lift↑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift↑}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ms}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{lift↑}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ms}\AgdaSpace{}%
\AgdaOperator{\AgdaField{>>=}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{lift∘>>=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ret↑}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lift∘>>=˘}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ms}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSymbol{\}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{lift↑}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ms}\AgdaSpace{}%
\AgdaOperator{\AgdaField{>>=}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{lift↑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift↑}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ms}\<%
\\
%
\>[2]\AgdaFunction{lift∘>>=˘}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{ms}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ret↑}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lift∘=<<}%
\>[12]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift∘>>=}\<%
\\
%
\>[2]\AgdaFunction{lift∘=<<˘}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift∘>>=˘}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{lift²∘>=>}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊢}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>=>}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaFunction{lift²∘>=>}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift∘=<<}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{lift²∘>=>˘}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>=>}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊢}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{lift²∘>=>˘}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift∘=<<˘}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{hoare-step}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{──────────────────────────}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{t}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[0]\AgdaFunction{hoare-step}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{t}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{PlQ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lift²∘>=>}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{map↑}\AgdaSpace{}%
\AgdaBound{PlQ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{consequence}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaGeneralizable{P′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊢}}\AgdaSpace{}%
\AgdaGeneralizable{P}%
\>[13]\AgdaComment{--\ \textasciicircum{}\ weakening\ the\ pre-condition}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaGeneralizable{Q}%
\>[7]\AgdaOperator{\AgdaFunction{⊢}}\AgdaSpace{}%
\AgdaGeneralizable{Q′}%
\>[13]\AgdaComment{--\ \textasciicircum{}\ strengthening\ the\ post-condition}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}%
\>[1731I]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}%
\>[9]\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q}%
\>[18]\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[.][@{}l@{}]\<[1731I]%
\>[4]\AgdaOperator{\AgdaFunction{───────────────}}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[0]\AgdaFunction{consequence}\AgdaSpace{}%
\AgdaBound{⊢P}\AgdaSpace{}%
\AgdaBound{Q⊢}\AgdaSpace{}%
\AgdaBound{PlQ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{map↑}\AgdaSpace{}%
\AgdaBound{Q⊢}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{PlQ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{⊢P}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ Utilities\ for\ Hoare\ triples.}\<%
\\
\>[0]\AgdaFunction{weaken}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{P′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊢}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[0]\AgdaFunction{weaken}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{consequence}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaFunction{id}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{strengthen}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊢}}\AgdaSpace{}%
\AgdaGeneralizable{Q′}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[0]\AgdaFunction{strengthen}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{consequence}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSpace{}%
\AgdaBound{H}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{axiom-base⋆}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[0]\AgdaFunction{axiom-base⋆}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{P}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{weaken}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{P′}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaKeyword{where}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ret↑}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{hoare-base}\<%
\\
\>[0]\AgdaFunction{axiom-base⋆}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{P}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{map↑}\AgdaSpace{}%
\AgdaFunction{id}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ Derived\ alternative\ formulation\ for\ step,\ using\ list\ concatenation.}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{hoare-step′}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}%
\>[13]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}%
\>[1869I]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{R}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[.][@{}l@{}]\<[1869I]%
\>[4]\AgdaOperator{\AgdaFunction{───────────────────}}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{R}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[0]\AgdaFunction{hoare-step′}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{P}\AgdaSymbol{\}\{}\AgdaBound{l}\AgdaSymbol{\}\{}\AgdaBound{Q}\AgdaSymbol{\}\{}\AgdaBound{l′}\AgdaSymbol{\}\{}\AgdaBound{R}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{PlQ}\AgdaSpace{}%
\AgdaBound{QlR}\<%
\\
\>[0]\AgdaComment{--\ \ \ \{s\}\ Ps\ rewrite\ comp\ \{l\}\{l′\}\ s}\<%
\\
\>[0]\AgdaComment{--\ \ \ with\ ⟦\ l\ ⟧\ s\ |\ PlQ\ Ps}\<%
\\
\>[0]\AgdaComment{--\ ...\ |\ .(just\ \AgdaUnderscore{})\ |\ ret↑\ Qs′\ =\ QlR\ Qs′}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{=}%
\>[1887I]\AgdaOperator{\AgdaField{begin}}\<%
\\
\>[.][@{}l@{}]\<[1887I]%
\>[4]\AgdaBound{P}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{⊢⟨}}\AgdaSpace{}%
\AgdaBound{PlQ}%
\>[10]\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{⊢⟨}}\AgdaSpace{}%
\AgdaFunction{map↑}\AgdaSpace{}%
\AgdaBound{QlR}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaBound{R}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{⊢⟨}}\AgdaSpace{}%
\AgdaFunction{lift²∘>=>}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}%
\>[29]\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaBound{R}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>=>}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{≗˘⟨}}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift↑}\AgdaSpace{}%
\AgdaBound{R}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{comp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{l}\AgdaSymbol{\}\{}\AgdaBound{l′}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaBound{R}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaBound{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∎}}\AgdaSpace{}%
\AgdaKeyword{where}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{⊢-Reasoning}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ **\ Reasoning\ syntax\ for\ Hoare\ triples.}\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{HoareReasoning}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaComment{--\ Reasoning\ newtype\ (for\ better\ type\ inference).}\<%
\\
%
\>[2]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{ℝ⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}⟨\AgdaUnderscore{}⟩}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Assertion}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{l}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{L}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Q}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Assertion}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{constructor}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{mkℝ\AgdaUnderscore{}}}\<%
\\
%
\>[4]\AgdaKeyword{field}\AgdaSpace{}%
\AgdaOperator{\AgdaField{begin\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[4]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{-2}\AgdaSpace{}%
\AgdaOperator{\AgdaField{begin\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaOperator{\AgdaModule{ℝ⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}⟨\AgdaUnderscore{}⟩}}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
%
\>[2]\AgdaKeyword{infix}%
\>[9]\AgdaNumber{-2}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{mkℝ\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaKeyword{infixr}\AgdaSpace{}%
\AgdaNumber{-1}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\textasciitilde{}⟪\AgdaUnderscore{}⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\textasciitilde{}⟨\AgdaUnderscore{}⟫\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\textasciitilde{}⟨\AgdaUnderscore{}∶-\AgdaUnderscore{}⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\textasciitilde{}⟨\AgdaUnderscore{}∶-\AgdaUnderscore{}⟩++\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaKeyword{infix}%
\>[9]\AgdaNumber{0}%
\>[12]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∎}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{--\ weakening\ syntax}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\textasciitilde{}⟪\AgdaUnderscore{}⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{P′}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{P′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊢}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{ℝ⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{R}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{ℝ⟨}}\AgdaSpace{}%
\AgdaBound{P′}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{R}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\textasciitilde{}⟪\AgdaUnderscore{}⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaBound{PlR}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{mkℝ}}\AgdaSpace{}%
\AgdaFunction{weaken}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{begin}}\AgdaSpace{}%
\AgdaBound{PlR}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{--\ strengthening\ syntax}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\textasciitilde{}⟨\AgdaUnderscore{}⟫\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{R′}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaGeneralizable{R}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊢}}\AgdaSpace{}%
\AgdaBound{R′}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{R}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{R′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\textasciitilde{}⟨\AgdaUnderscore{}⟫\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaBound{PlR}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{strengthen}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaBound{PlR}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{--\ step\ syntax}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\textasciitilde{}⟨\AgdaUnderscore{}∶-\AgdaUnderscore{}⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{P′}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{ℝ⟨}}\AgdaSpace{}%
\AgdaBound{P′}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{ℝ⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{R}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{ℝ⟨}}\AgdaSpace{}%
\AgdaBound{P′}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{R}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\textasciitilde{}⟨\AgdaUnderscore{}∶-\AgdaUnderscore{}⟩\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{R}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{R}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{P′}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaBound{PlR}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{mkℝ}}\AgdaSpace{}%
\AgdaFunction{go}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{go}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{P′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊢}}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\<%
\\
%
\>[6]\AgdaFunction{go}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{P′s}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{begin}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{P′s}\<%
\\
%
\>[6]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{ret↑}\AgdaSpace{}%
\AgdaBound{Ps′}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{begin}}\AgdaSpace{}%
\AgdaBound{PlR}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{Ps′}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{--\ step′\ syntax}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\textasciitilde{}⟨\AgdaUnderscore{}∶-\AgdaUnderscore{}⟩++\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{P′}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{l}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{L}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{ℝ⟨}}\AgdaSpace{}%
\AgdaBound{P′}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{ℝ⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{R}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{ℝ⟨}}\AgdaSpace{}%
\AgdaBound{P′}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{R}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\<%
\\
%
\>[2]\AgdaBound{P′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\textasciitilde{}⟨}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∶-}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩++}}\AgdaSpace{}%
\AgdaBound{PlR}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{mkℝ}}\AgdaSpace{}%
\AgdaFunction{hoare-step′}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{begin}}\AgdaSpace{}%
\AgdaBound{H}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{begin}}\AgdaSpace{}%
\AgdaBound{PlR}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∎}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{ℝ⟨}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟨}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaRecord{⟩}}\<%
\\
%
\>[2]\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∎}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{mkℝ}}\AgdaSpace{}%
\AgdaFunction{hoare-base}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{P}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{\}}\<%
\end{code}
\begin{minipage}{.4\textwidth}
\begin{code}%
\>[0]\AgdaFunction{⊎-⟦⟧}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s₁′}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaGeneralizable{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{s₁′}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}%
\>[2198I]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊎}}\AgdaSpace{}%
\AgdaGeneralizable{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩≡}}\AgdaSpace{}%
\AgdaGeneralizable{s}\<%
\\
\>[.][@{}l@{}]\<[2198I]%
\>[4]\AgdaOperator{\AgdaFunction{────────────────────────────}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{s₁′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊎}}\AgdaSpace{}%
\AgdaGeneralizable{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩≡\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaGeneralizable{s}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{⊎-⟦⟧}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{TODO}\<%
\\
\>[0]\AgdaKeyword{postulate}\AgdaSpace{}%
\AgdaKeyword{instance}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaPostulate{Apart-L}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{L}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{//\textasciicircum{}⦅}}\AgdaSpace{}%
\AgdaFunction{0ℓ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⦆}}\AgdaSpace{}%
\AgdaFunction{Assertion}\<%
\end{code}
\vspace{-.5cm}
\begin{code}%
\>[0]\AgdaFunction{[FRAME]}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaField{♯}}\AgdaSpace{}%
\AgdaBound{R}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}%
\>[2229I]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[.][@{}l@{}]\<[2229I]%
\>[4]\AgdaOperator{\AgdaFunction{─────────────────}}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∗}}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∗}}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{[FRAME]}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{l}\AgdaSymbol{\}\{}\AgdaBound{P}\AgdaSymbol{\}\{}\AgdaBound{Q}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaBound{l♯R}\AgdaSpace{}%
\AgdaBound{PlQ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{≡s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Ps₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Rs₂}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaKeyword{in}\AgdaSpace{}%
\AgdaArgument{s₁≡}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{PlQ}\AgdaSpace{}%
\AgdaBound{Ps₁}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{s₁′}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{ret↑}\AgdaSpace{}%
\AgdaBound{Qs₁′}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaKeyword{in}\AgdaSpace{}%
\AgdaArgument{s≡}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{⊎-⟦⟧}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{s₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{s₂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{s₁′}\AgdaSpace{}%
\AgdaBound{s₁≡}\AgdaSpace{}%
\AgdaBound{≡s}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[2295I]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{s′}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{ret↑}\AgdaSpace{}%
\AgdaBound{≡s′}\<%
\\
\>[.][@{}l@{}]\<[2295I]%
\>[4]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ret↑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s₁′}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{≡s′}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Qs₁′}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Rs₂}\AgdaSymbol{)}\<%
\end{code}
\end{minipage}
\hfill\vrule\hfill
\begin{minipage}{.5\textwidth}
\begin{code}%
\>[0]\AgdaFunction{[PAR]}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaGeneralizable{l₁}\AgdaSpace{}%
\AgdaOperator{\AgdaField{♯}}\AgdaSpace{}%
\AgdaGeneralizable{P₂}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaGeneralizable{l₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{♯}}\AgdaSpace{}%
\AgdaGeneralizable{P₁}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaGeneralizable{l₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∥}}\AgdaSpace{}%
\AgdaGeneralizable{l₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≡}}\AgdaSpace{}%
\AgdaGeneralizable{l}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}%
\>[2330I]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[.][@{}l@{}]\<[2330I]%
\>[4]\AgdaOperator{\AgdaFunction{───────────────────────────}}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∗}}\AgdaSpace{}%
\AgdaGeneralizable{P₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∗}}\AgdaSpace{}%
\AgdaGeneralizable{Q₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{[PAR]}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{TODO}\<%
\end{code}
\end{minipage}
\end{frame}
\end{document}
