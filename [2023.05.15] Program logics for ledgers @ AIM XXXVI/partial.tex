\documentclass[main]{subfiles}
\begin{document}
\begin{frame}[fragile]{Adding Partiality}
\begin{code}[hide]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Init}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{SetAsType}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.General}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.DecEq}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Decidable}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Ord}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Semigroup}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Monoid}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Functor}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.InferenceRules}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Apartness}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Monad}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Prelude.Lists}\AgdaSpace{}%
\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↦\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{ValueSepExact.Maps}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Part}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{DecEq}\AgdaSpace{}%
\AgdaBound{Part}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{Map⟨\AgdaUnderscore{}↦\AgdaUnderscore{}⟩}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{Map⟨}}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↦}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Map⟨}\AgdaSpace{}%
\AgdaBound{K}\AgdaSpace{}%
\AgdaFunction{↦ℕ⟩}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{postulate}\AgdaSpace{}%
\AgdaPostulate{TODO}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaGeneralizable{ℓ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{variable}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaGeneralizable{A}\AgdaSpace{}%
\AgdaGeneralizable{B}\AgdaSpace{}%
\AgdaGeneralizable{C}\AgdaSpace{}%
\AgdaGeneralizable{D}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Part}\<%
\\
%
\>[2]\AgdaGeneralizable{v}\AgdaSpace{}%
\AgdaGeneralizable{v′}\AgdaSpace{}%
\AgdaGeneralizable{v″}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\<%
\end{code}
\begin{code}%
\>[0]\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{Map⟨}}\AgdaSpace{}%
\AgdaBound{Part}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↦}}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[0]\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{Tx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{constructor}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}—→⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaKeyword{field}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaField{sender}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Part}\<%
\\
%
\>[4]\AgdaField{value}%
\>[13]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\<%
\\
%
\>[4]\AgdaField{receiver}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Part}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Tx}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
\>[0]\AgdaKeyword{unquoteDecl}\AgdaSpace{}%
\AgdaFunction{DecEq-Tx}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaMacro{DERIVE}\AgdaSpace{}%
\AgdaRecord{DecEq}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaKeyword{quote}\AgdaSpace{}%
\AgdaRecord{Tx}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{DecEq-Tx}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{L}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaRecord{Tx}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{variable}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaGeneralizable{s′}\AgdaSpace{}%
\AgdaGeneralizable{s″}\AgdaSpace{}%
\AgdaGeneralizable{s₁}\AgdaSpace{}%
\AgdaGeneralizable{s₁′}\AgdaSpace{}%
\AgdaGeneralizable{s₁″}\AgdaSpace{}%
\AgdaGeneralizable{s₂}\AgdaSpace{}%
\AgdaGeneralizable{s₂′}\AgdaSpace{}%
\AgdaGeneralizable{s₂″}\AgdaSpace{}%
\AgdaGeneralizable{s₃}\AgdaSpace{}%
\AgdaGeneralizable{s₃′}\AgdaSpace{}%
\AgdaGeneralizable{s₃″}\AgdaSpace{}%
\AgdaGeneralizable{s₂₃}\AgdaSpace{}%
\AgdaGeneralizable{s₂₃′}\AgdaSpace{}%
\AgdaGeneralizable{s₂₃″}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{S}\<%
\\
%
\>[2]\AgdaGeneralizable{t}\AgdaSpace{}%
\AgdaGeneralizable{t′}\AgdaSpace{}%
\AgdaGeneralizable{t″}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Tx}\<%
\\
%
\>[2]\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaGeneralizable{l″}\AgdaSpace{}%
\AgdaGeneralizable{l₁}\AgdaSpace{}%
\AgdaGeneralizable{l₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{L}\<%
\\
%
\>[2]\AgdaGeneralizable{ls}\AgdaSpace{}%
\AgdaGeneralizable{ls′}\AgdaSpace{}%
\AgdaGeneralizable{ls″}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{L}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaFunction{S}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaGeneralizable{ms}\AgdaSpace{}%
\AgdaGeneralizable{ms′}\AgdaSpace{}%
\AgdaGeneralizable{ms″}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaFunction{S}\<%
\\
%
\>[2]\AgdaGeneralizable{mls}\AgdaSpace{}%
\AgdaGeneralizable{mls′}\AgdaSpace{}%
\AgdaGeneralizable{mls″}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{L}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSymbol{)}\<%
\end{code}
\begin{code}%
\>[0]\AgdaFunction{Domain}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaFunction{S}\<%
\\
\>[0]\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{Denotable}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{field}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Domain}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Denotable}\AgdaSpace{}%
\AgdaSymbol{⦃...⦄}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{Domain₀}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{S}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{Denotable₀}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{field}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧₀}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Domain₀}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Denotable₀}\AgdaSpace{}%
\AgdaSymbol{⦃...⦄}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
\>[0]\AgdaFunction{IsValidTx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Tx}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
\>[0]\AgdaFunction{IsValidTx}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{—→⟨}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⟩}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaField{≤}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{IsValidTx′}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Tx}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{mkValid}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaGeneralizable{v}\AgdaSpace{}%
\AgdaOperator{\AgdaField{≤}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaGeneralizable{A}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{──────────────────────────}}\<%
\\
%
\>[4]\AgdaDatatype{IsValidTx′}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{—→⟨}}\AgdaSpace{}%
\AgdaGeneralizable{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaGeneralizable{s}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{isValidTx?}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Decidable²}\AgdaSpace{}%
\AgdaFunction{IsValidTx}\<%
\\
\>[0]\AgdaFunction{isValidTx?}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{dec²}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{isValidTx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Tx}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{isValidTx}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⌊}}\AgdaSpace{}%
\AgdaFunction{isValidTx?}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⌋}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ Express\ the\ action\ of\ tranferring\ values\ between\ keys\ in\ a\ map.}\<%
\\
\>[0]\AgdaComment{--\ NB:\ a\ transaction\ goes\ through\ only\ when:}\<%
\\
\>[0]\AgdaComment{--\ \ \ 1.\ both\ participants\ are\ present\ in\ the\ domain}\<%
\\
\>[0]\AgdaComment{--\ \ \ 2.\ the\ sender\ holds\ sufficient\ funds}\<%
\\
\>[0]\AgdaKeyword{instance}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaComment{--\ we\ denote\ a\ transaction\ as\ the\ map\ transformation\ that\ implements\ the\ transfer}\<%
\\
%
\>[2]\AgdaFunction{⟦Tx⟧₀}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Denotable₀}\AgdaSpace{}%
\AgdaRecord{Tx}\<%
\\
%
\>[2]\AgdaFunction{⟦Tx⟧₀}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧₀}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{—→⟨}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⟩}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↝}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}∸}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↝}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{⟦L⟧₀}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Denotable₀}\AgdaSpace{}%
\AgdaFunction{L}\<%
\\
%
\>[2]\AgdaFunction{⟦L⟧₀}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧₀}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}%
\>[21]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{id}\<%
\\
%
\>[2]\AgdaFunction{⟦L⟧₀}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧₀}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\<%
\end{code}
\begin{code}%
%
\>[2]\AgdaFunction{⟦T⟧}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Denotable}\AgdaSpace{}%
\AgdaRecord{Tx}\<%
\\
%
\>[2]\AgdaFunction{⟦T⟧}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{M.when}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{isValidTx}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{⟦L⟧}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Denotable}\AgdaSpace{}%
\AgdaFunction{L}\<%
\\
%
\>[2]\AgdaFunction{⟦L⟧}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}%
\>[19]\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
%
\>[2]\AgdaFunction{⟦L⟧}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>=>}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{comp₀}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaFunction{comp₀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}%
\>[18]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{comp₀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{comp₀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\end{code}
\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaFunction{comp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>=>}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{comp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}%
\>[17]\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{comp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{nothing}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{s}%
\>[14]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{comp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ Executing\ transactions\ never\ introduces\ new\ keys\ in\ the\ resulting\ map\ out-of-thin-air.}\<%
\\
\>[0]\AgdaComment{--\ **\ Operational\ semantics}\<%
\\
\>[0]\AgdaComment{--\ We\ model\ configurations\ of\ the\ transition\ system\ as\ pairs\ of\ a\ ledger\ and\ its\ current\ state.}\<%
\end{code}
\end{frame}
\begin{frame}{Adding Partiality: Operational Semantics}
\begin{code}%
\>[0]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}—→\AgdaUnderscore{}}}\<%
\\
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}—→\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{L}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Type}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{base}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaOperator{\AgdaFunction{────────────}}\<%
\\
%
\>[4]\AgdaField{ε}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaInductiveConstructor{step}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaFunction{IsValidTx}\AgdaSpace{}%
\AgdaGeneralizable{t}\AgdaSpace{}%
\AgdaGeneralizable{s}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{∙}}%
\>[420I]\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{t}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
\>[.][@{}l@{}]\<[420I]%
\>[6]\AgdaOperator{\AgdaFunction{──────────────────}}\<%
\\
%
\>[6]\AgdaGeneralizable{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{oper-comp}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaGeneralizable{l}%
\>[12]\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}%
\>[17]\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}%
\>[438I]\AgdaGeneralizable{l′}%
\>[12]\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s′}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s″}\<%
\\
\>[.][@{}l@{}]\<[438I]%
\>[4]\AgdaOperator{\AgdaFunction{──────────────────}}\<%
\\
%
\>[4]\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}%
\>[17]\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s″}\<%
\\
\>[0]\AgdaFunction{oper-comp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}%
\>[22]\AgdaInductiveConstructor{base}%
\>[45]\AgdaBound{s′→s″}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{s′→s″}\<%
\\
\>[0]\AgdaFunction{oper-comp}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{step}\AgdaSpace{}%
\AgdaBound{v≤}\AgdaSpace{}%
\AgdaBound{s→s′}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s′→s″}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{step}\AgdaSpace{}%
\AgdaBound{v≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{oper-comp}\AgdaSpace{}%
\AgdaBound{s→s′}\AgdaSpace{}%
\AgdaBound{s′→s″}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{oper-comp˘}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaGeneralizable{l′}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}%
\>[17]\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s″}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{────────────────────────}}\<%
\\
%
\>[4]\AgdaFunction{∃}%
\>[473I]\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{s′}\<%
\\
\>[.][@{}l@{}]\<[473I]%
\>[6]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{l}%
\>[17]\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}%
\>[22]\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaBound{s′}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{l′}%
\>[17]\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{s′}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s″}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{oper-comp˘}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l′}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l′}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{-,}}\AgdaSpace{}%
\AgdaInductiveConstructor{base}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaFunction{oper-comp˘}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l′}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l′}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{step}\AgdaSpace{}%
\AgdaBound{v≤}\AgdaSpace{}%
\AgdaBound{s→s′}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{s→}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{→s′}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{oper-comp˘}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{l}\AgdaSymbol{\}\{}\AgdaBound{l′}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{s→s′}\<%
\\
%
\>[2]\AgdaKeyword{in}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{-,}}\AgdaSpace{}%
\AgdaInductiveConstructor{step}\AgdaSpace{}%
\AgdaBound{v≤}\AgdaSpace{}%
\AgdaBound{s→}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{→s′}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--\ **\ Relating\ denotational\ and\ operational\ semantics.}\<%
\\
\>[0]\AgdaFunction{denot⇒oper}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{─────────────────}}\<%
\\
%
\>[2]\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
\>[0]\AgdaFunction{denot⇒oper}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{base}\<%
\\
\>[0]\AgdaFunction{denot⇒oper}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{—→⟨}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⟩}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{l≡}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{v≤}\ ←\ \AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≤?}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\>[2]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{step}\AgdaSpace{}%
\AgdaBound{v≤}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{denot⇒oper}\AgdaSpace{}%
\AgdaBound{l≡}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{oper⇒denot}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{─────────────────}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
\>[0]\AgdaFunction{oper⇒denot}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaInductiveConstructor{[]}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaInductiveConstructor{base}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{oper⇒denot}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{—→⟨}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⟩}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{step}\AgdaSpace{}%
\AgdaBound{v≤}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{dec-yes}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{v}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≤?}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{v≤}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaField{proj₂}\<%
\\
%
\>[2]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{oper⇒denot}\AgdaSpace{}%
\AgdaBound{p}\<%
\end{code}

\begin{code}%
\>[0]\AgdaFunction{denot⇔oper}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{═════════════════}}\<%
\\
%
\>[2]\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{denot⇔oper}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{denot⇒oper}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{oper⇒denot}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{oper⇒denot₀}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{—→}}\AgdaSpace{}%
\AgdaGeneralizable{s′}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{─────────────}}\<%
\\
%
\>[2]\AgdaGeneralizable{s′}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧₀}}\AgdaSpace{}%
\AgdaGeneralizable{s}\<%
\\
\>[0]\AgdaFunction{oper⇒denot₀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaInductiveConstructor{base}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{oper⇒denot₀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{step}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{l→}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{oper⇒denot₀}\AgdaSpace{}%
\AgdaBound{l→}\<%
\end{code}
\end{frame}
\begin{frame}{Adding Partiality: Lifting Predicates for Hoare Logic}
\begin{code}[hide]%
\>[0]\AgdaFunction{Assertion}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Pred₀}\AgdaSpace{}%
\AgdaFunction{S}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{variable}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaGeneralizable{P′}\AgdaSpace{}%
\AgdaGeneralizable{P₁}\AgdaSpace{}%
\AgdaGeneralizable{P₂}\AgdaSpace{}%
\AgdaGeneralizable{Q}\AgdaSpace{}%
\AgdaGeneralizable{Q′}\AgdaSpace{}%
\AgdaGeneralizable{Q₁}\AgdaSpace{}%
\AgdaGeneralizable{Q₂}\AgdaSpace{}%
\AgdaGeneralizable{R}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Assertion}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{emp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Assertion}\<%
\\
\>[0]\AgdaFunction{emp}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaNumber{0}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∗\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Op₂}\AgdaSpace{}%
\AgdaFunction{Assertion}\<%
\\
\>[0]\AgdaSymbol{(}\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∗}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{∃}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{∃}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{◇}}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩≡}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaBound{s₂}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↦\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{Part}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Assertion}\<%
\\
\>[0]\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↦}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}[}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↦}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]∅}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{infixr}\AgdaSpace{}%
\AgdaNumber{10}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∗\AgdaUnderscore{}}}\<%
\\
\>[0]\AgdaKeyword{infix}%
\>[7]\AgdaNumber{11}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↦\AgdaUnderscore{}}}\<%
\\
\>[0]\AgdaKeyword{infixl}\AgdaSpace{}%
\AgdaNumber{4}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↑∘\AgdaUnderscore{}}}\<%
\end{code}
\begin{code}%
\>[0]\AgdaFunction{weak↑}\AgdaSpace{}%
\AgdaFunction{strong↑}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred₀}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Pred₀}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{weak↑}%
\>[9]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{M.All.All}\<%
\\
\>[0]\AgdaFunction{strong↑}%
\>[9]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{M.Any.Any}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↑∘\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Pred₀}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{S}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaFunction{S}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Pred₀}\AgdaSpace{}%
\AgdaFunction{S}\<%
\\
\>[0]\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{strong↑}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{f}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{lift↑}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{strong↑}\<%
\\
\>[0]\AgdaKeyword{pattern}\AgdaSpace{}%
\AgdaInductiveConstructor{ret↑}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{M.Any.just}\AgdaSpace{}%
\AgdaBound{x}\<%
\end{code}

\begin{code}%
\>[0]\AgdaOperator{\AgdaFunction{⟨\AgdaUnderscore{}⟩\AgdaUnderscore{}⟨\AgdaUnderscore{}⟩}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Assertion}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{L}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Assertion}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Type}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊢}}\AgdaSpace{}%
\AgdaBound{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\<%
\end{code}
\end{frame}
\begin{frame}{Adding Partiality: Frame Rule}
\begin{code}%
\>[0]\AgdaFunction{◇-⟦⟧}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s₁′}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaGeneralizable{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{s₁′}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}%
\>[776I]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{◇}}\AgdaSpace{}%
\AgdaGeneralizable{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩≡}}\AgdaSpace{}%
\AgdaGeneralizable{s}\<%
\\
\>[.][@{}l@{}]\<[776I]%
\>[4]\AgdaOperator{\AgdaFunction{────────────────────────────}}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaBound{s₁′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{◇}}\AgdaSpace{}%
\AgdaGeneralizable{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩≡\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{↑∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaGeneralizable{s}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{◇-⟦⟧}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{TODO}\<%
\end{code}

\begin{code}%
\>[0]\AgdaFunction{[FRAME]}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{─────────────────────}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∗}}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∗}}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{[FRAME]}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{P}\AgdaSymbol{\}\{}\AgdaBound{l}\AgdaSymbol{\}\{}\AgdaBound{Q}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{R}\AgdaSpace{}%
\AgdaBound{PlQ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{≡s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Ps₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Rs₂}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaKeyword{in}\AgdaSpace{}%
\AgdaArgument{s₁≡}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{PlQ}\AgdaSpace{}%
\AgdaBound{Ps₁}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{s₁′}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{ret↑}\AgdaSpace{}%
\AgdaBound{Qs₁′}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaKeyword{in}\AgdaSpace{}%
\AgdaArgument{s≡}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{◇-⟦⟧}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{l}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{s₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{s₂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{s₁′}\AgdaSpace{}%
\AgdaBound{s₁≡}\AgdaSpace{}%
\AgdaBound{≡s}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{.}\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{s′}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{ret↑}\AgdaSpace{}%
\AgdaBound{≡s′}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ret↑}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s₁′}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{≡s′}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Qs₁′}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Rs₂}\AgdaSymbol{)}\<%
\end{code}
\end{frame}
\begin{frame}{Adding Partiality: Parallel Rule}
\begin{code}%
\>[0]\AgdaFunction{◇-interleave}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{l₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∥}}\AgdaSpace{}%
\AgdaGeneralizable{l₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≡}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{◇}}\AgdaSpace{}%
\AgdaGeneralizable{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩≡}}\AgdaSpace{}%
\AgdaGeneralizable{s}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaGeneralizable{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaGeneralizable{s₁′}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}%
\>[896I]\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaGeneralizable{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaGeneralizable{s₂′}\<%
\\
\>[.][@{}l@{}]\<[896I]%
\>[4]\AgdaOperator{\AgdaFunction{───────────────────────────}}\<%
\\
%
\>[4]\AgdaFunction{∃}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{s′}%
\>[905I]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{s′}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[905I]%
\>[11]\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{s₁′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{◇}}\AgdaSpace{}%
\AgdaGeneralizable{s₂′}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩≡}}\AgdaSpace{}%
\AgdaBound{s′}\AgdaSymbol{)}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{◇-interleave}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{TODO}\<%
\end{code}

\begin{code}%
\>[0]\AgdaFunction{[PAR]}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaGeneralizable{l₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∥}}\AgdaSpace{}%
\AgdaGeneralizable{l₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≡}}\AgdaSpace{}%
\AgdaGeneralizable{l}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{∙}}%
\>[934I]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\\
\>[.][@{}l@{}]\<[934I]%
\>[4]\AgdaOperator{\AgdaFunction{─────────────────────────}}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{P₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∗}}\AgdaSpace{}%
\AgdaGeneralizable{P₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaGeneralizable{l}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaGeneralizable{Q₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∗}}\AgdaSpace{}%
\AgdaGeneralizable{Q₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\<%
\end{code}
\begin{code}[hide]%
\>[0]\AgdaFunction{[PAR]}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{l₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{l₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{l}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{≡l}\AgdaSpace{}%
\AgdaBound{Pl₁Q}\AgdaSpace{}%
\AgdaBound{Pl₂Q}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{≡s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Ps₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Ps₂}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaKeyword{in}\AgdaSpace{}%
\AgdaArgument{ls₁}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Pl₁Q}\AgdaSpace{}%
\AgdaBound{Ps₁}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{s₁′}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{M.Any.just}\AgdaSpace{}%
\AgdaBound{Qs₁′}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟦}}\AgdaSpace{}%
\AgdaBound{l₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{⟧}}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaKeyword{in}\AgdaSpace{}%
\AgdaArgument{ls₂}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{Pl₂Q}\AgdaSpace{}%
\AgdaBound{Ps₂}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{s₂′}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{M.Any.just}\AgdaSpace{}%
\AgdaBound{Qs₂′}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{s′}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{≡s′}\ ←\ \AgdaFunction{◇-interleave}\AgdaSpace{}%
\AgdaBound{≡l}\AgdaSpace{}%
\AgdaBound{≡s}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaBound{ls₂}\<%
\\
%
\>[2]\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaBound{ls}\<%
\\
%
\>[2]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{M.Any.just}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s₁′}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{s₂′}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{≡s′}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Qs₁′}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{Qs₂′}\AgdaSymbol{)}\<%
\end{code}
\end{frame}
\end{document}
